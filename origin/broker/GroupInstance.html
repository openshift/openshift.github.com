<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: GroupInstance
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (G)</a> &raquo;
    
    
    <span class="title">GroupInstance</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: GroupInstance
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">GroupInstance</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2">Mongoid::Document</dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">origin-server/controller/app/models/group_instance.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
Represents a group of gears what scale together and have the same
components installed.
</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#app_dns-instance_method" title="#app_dns (instance method)">- (Boolean) <strong>app_dns</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Indicates if the group instance hosts the web_proxy component and has the
Application DNS pointed to it.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#application-instance_method" title="#application (instance method)">- (Application) <strong>application</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
That this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span> is part of.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#gears-instance_method" title="#gears (instance method)">- (Array[Gear]) <strong>gears</strong> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
List of gears that are part of this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span>.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#max-instance_method" title="#max (instance method)">- (Integer) <strong>max</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Calculated maximum set of gears supported by <span class='object_link'><a href="ComponentInstance.html" title="ComponentInstance (class)">ComponentInstance</a></span>s in the
group.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#min-instance_method" title="#min (instance method)">- (Integer) <strong>min</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Calculated minimum set of gears supported by <span class='object_link'><a href="ComponentInstance.html" title="ComponentInstance (class)">ComponentInstance</a></span>s in the
group.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#user_max-instance_method" title="#user_max (instance method)">- (Integer) <strong>user_max</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
User set maximum number of gears.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#user_min-instance_method" title="#user_min (instance method)">- (Integer) <strong>user_min</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
User set minimum number of gears.
</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#run_on_gears-class_method" title="run_on_gears (class method)">+ (Object) <strong>run_on_gears</strong>(gears = nil, result_io = nil, fail_fast = true, &amp;block) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Run an operation on a list of gears on this group instance.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_configuration-class_method" title="update_configuration (class method)">+ (Object) <strong>update_configuration</strong>(add_keys = [], remove_keys = [], add_envs = [], remove_envs = [], gears = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Adds ssh keys to all gears within the group instance.
</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addtl_fs_gb-instance_method" title="#addtl_fs_gb (instance method)">- (Object) <strong>addtl_fs_gb</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addtl_fs_gb%3D-instance_method" title="#addtl_fs_gb= (instance method)">- (Object) <strong>addtl_fs_gb=</strong>(value) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#all_component_instances-instance_method" title="#all_component_instances (instance method)">- (Object) <strong>all_component_instances</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#component_instances-instance_method" title="#component_instances (instance method)">- (Object) <strong>component_instances</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gear_size-instance_method" title="#gear_size (instance method)">- (Object) <strong>gear_size</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gear_size%3D-instance_method" title="#gear_size= (instance method)">- (Object) <strong>gear_size=</strong>(value) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#get_attribute_value-instance_method" title="#get_attribute_value (instance method)">- (Object) <strong>get_attribute_value</strong>(attr) </a>
    

    
  </span>
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_group_override-instance_method" title="#get_group_override (instance method)">- (Object) <strong>get_group_override</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (GroupInstance) <strong>initialize</strong>(attrs = nil, options = nil) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Initializes the application.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#singleton_instances-instance_method" title="#singleton_instances (instance method)">- (Object) <strong>singleton_instances</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_hash-instance_method" title="#to_hash (instance method)">- (Hash) <strong>to_hash</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
A simplified hash representing this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span> object which is used by
<span class='object_link'><a href="Application.html#compute_diffs-instance_method" title="Application#compute_diffs (method)">Application#compute_diffs</a></span>.
</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span></tt>) <strong>initialize</strong>(attrs = nil, options = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Initializes the application
</p>
<h2>Parameters:</h2>
<table>
<tr><td valign="top">custom_id:</td><td>Specify a Moped::BSON::ObjectId to identify this instance

</td></tr>
<tr><td valign="top">app_dns:</td><td>Specified that this group instance hosts the primary application DNS
endpoint. @Note used when this gear is hosting the web_proxy component

</td></tr>
</table>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


31
32
33
34
35
36</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 31</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='assign token'>=</span> <span class='rubyid_attrs identifier id'>attrs</span><span class='lbrack token'>[</span><span class='symbol val'>:custom_id</span><span class='rbrack token'>]</span>
  <span class='rubyid_attrs identifier id'>attrs</span><span class='dot token'>.</span><span class='rubyid_delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:custom_id</span><span class='rparen token'>)</span>
  <span class='rubyid_super super kw'>super</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span> <span class='assign token'>=</span> <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_custom_id identifier id'>custom_id</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="app_dns-instance_method">
  
    - (<tt>Boolean</tt>) <strong>app_dns</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Indicates if the group instance hosts the web_proxy component and has the
Application DNS pointed to it.
</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
Indicates if the group instance hosts the web_proxy component and has the
Application DNS pointed to it.
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 16</span>

<span class='rubyid_class class kw'>class</span> <span class='rubyid_GroupInstance constant id'>GroupInstance</span>
  <span class='rubyid_include identifier id'>include</span> <span class='rubyid_Mongoid constant id'>Mongoid</span><span class='colon2 op'>::</span><span class='rubyid_Document constant id'>Document</span>
  <span class='rubyid_embedded_in identifier id'>embedded_in</span> <span class='symbol val'>:application</span><span class='comma token'>,</span> <span class='rubyid_class_name identifier id'>class_name</span><span class='colon op'>:</span> <span class='rubyid_Application constant id'>Application</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
  <span class='rubyid_embeds_many identifier id'>embeds_many</span> <span class='symbol val'>:gears</span><span class='comma token'>,</span> <span class='rubyid_class_name identifier id'>class_name</span><span class='colon op'>:</span> <span class='rubyid_Gear constant id'>Gear</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
  
  <span class='rubyid_attr_accessor identifier id'>attr_accessor</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:max</span>
  
  <span class='comment val'># Initializes the application</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># custom_id::</span>
  <span class='comment val'>#   Specify a Moped::BSON::ObjectId to identify this instance</span>
  <span class='comment val'># app_dns::</span>
  <span class='comment val'>#   Specified that this group instance hosts the primary application DNS endpoint.</span>
  <span class='comment val'>#   @Note used when this gear is hosting the web_proxy component</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='assign token'>=</span> <span class='rubyid_attrs identifier id'>attrs</span><span class='lbrack token'>[</span><span class='symbol val'>:custom_id</span><span class='rbrack token'>]</span>
    <span class='rubyid_attrs identifier id'>attrs</span><span class='dot token'>.</span><span class='rubyid_delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:custom_id</span><span class='rparen token'>)</span>
    <span class='rubyid_super super kw'>super</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span> <span class='assign token'>=</span> <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_custom_id identifier id'>custom_id</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_component_instances identifier id'>component_instances</span>
    <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='notop op'>!</span><span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_singleton_instances identifier id'>singleton_instances</span>
    <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span>
    <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='dot token'>.</span><span class='rubyid_where identifier id'>where</span><span class='lparen token'>(</span><span class='rubyid_group_instance_id identifier id'>group_instance_id</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size identifier id'>gear_size</span>
    <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;gear_size&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_default_gear_size identifier id'>default_gear_size</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size= identifier id'>gear_size=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;gear_size&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span>
    <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb= identifier id'>addtl_fs_gb=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Adds ssh keys to all gears within the group instance.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># add_keys::</span>
  <span class='comment val'>#   Array of Hash containing name, type, content of the ssh keys</span>
  <span class='comment val'># remove_keys::</span>
  <span class='comment val'>#   Array of Hash containing name, type, content of the ssh keys  </span>
  <span class='comment val'># add_envs::</span>
  <span class='comment val'>#   Array of Hash containing key, value of the environment variables</span>
  <span class='comment val'># remove_envs::</span>
  <span class='comment val'>#   Array of Hash containing key, value of the environment variables</span>
  <span class='comment val'># gears::</span>
  <span class='comment val'>#   List of gears to apply these changes to</span>
  <span class='comment val'>#   @Note Used internally during create/scale-up operations</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_update_configuration identifier id'>update_configuration</span><span class='lparen token'>(</span><span class='rubyid_add_keys identifier id'>add_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_handle identifier id'>handle</span> <span class='assign token'>=</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_create_parallel_job identifier id'>create_parallel_job</span>
    <span class='rubyid_tag identifier id'>tag</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
    
    <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_run_parallel_on_gears identifier id'>run_parallel_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='comma token'>,</span> <span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
      <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_add_authorized_ssh_key_job identifier id'>get_add_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;type&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_remove_authorized_ssh_key_job identifier id'>get_remove_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

      <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_add_job identifier id'>get_env_var_add_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;value&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_remove_job identifier id'>get_env_var_remove_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_ResultIO constant id'>ResultIO</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span>
    <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_get_parallel_run_results identifier id'>get_parallel_run_results</span><span class='lparen token'>(</span><span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_output identifier id'>output</span><span class='comma token'>,</span> <span class='rubyid_status identifier id'>status</span><span class='bitor op'>|</span>
      <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_output identifier id'>output</span>
      <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_exitcode identifier id'>exitcode</span> <span class='assign token'>=</span> <span class='rubyid_status identifier id'>status</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_status identifier id'>status</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
        <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_NodeException constant id'>NodeException</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Error applying settings to gear: #{gear} with status: #{status} and output: #{output}&quot;</span><span class='comma token'>,</span> <span class='integer val'>143</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_result_io identifier id'>result_io</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># @return [Hash] a simplified hash representing this {GroupInstance} object which is used by {Application#compute_diffs}  </span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_to_hash identifier id'>to_hash</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='lbrace token'>{</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='colon op'>:</span> <span class='rubyid_comps identifier id'>comps</span><span class='comma token'>,</span> <span class='rubyid_scale identifier id'>scale</span><span class='colon op'>:</span> <span class='lbrace token'>{</span><span class='rubyid_current identifier id'>current</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span><span class='comma token'>,</span> <span class='rubyid_additional_filesystem_gb identifier id'>additional_filesystem_gb</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span><span class='comma token'>,</span> <span class='rubyid_gear_size identifier id'>gear_size</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gear_size identifier id'>gear_size</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='rubyid__id identifier id'>_id</span><span class='colon op'>:</span> <span class='rubyid__id identifier id'>_id</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_get_group_override identifier id'>get_group_override</span>
    <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
      <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
          <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span>
          <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_break break kw'>break</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
      <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_value identifier id'>value</span> <span class='rubyid_or or kw'>or</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;components&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span><span class='lbrack token'>[</span><span class='symbol val'>:component_instances</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_protected identifier id'>protected</span>
  
  <span class='comment val'># Run an operation on a list of gears on this group instance.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># gears::</span>
  <span class='comment val'>#   Array of {Gear}s to run the operation on</span>
  <span class='comment val'>#</span>
  <span class='comment val'># result_io::</span>
  <span class='comment val'>#   {ResultIO} object to collect stderr/stdout and exitcode from the operation</span>
  <span class='comment val'>#</span>
  <span class='comment val'># fail_fast::</span>
  <span class='comment val'>#   Boolean to indicate if the operation should fail fast and raise an exception on the first failing gear.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># block::</span>
  <span class='comment val'>#   code block to run on all gears.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Returns:</span>
  <span class='comment val'># successful runs::</span>
  <span class='comment val'>#   List of gears where the operation was successful. Each entry is a Hash :gear -&gt; {Gear}, :return -&gt; exitcode of the operation</span>
  <span class='comment val'># failed_runs::</span>
  <span class='comment val'>#   List of gears where the operation was not successful. Each entry is a Hash :gear -&gt; {Gear}, :exception -&gt; exception raised by the operation</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Raises:</span>
  <span class='comment val'># {Exception} if a gear operation fails and fail_fast is true</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_run_on_gears identifier id'>run_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span><span class='assign token'>=</span><span class='rubyid_true true kw'>true</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
    <span class='rubyid_successful_runs identifier id'>successful_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_failed_runs identifier id'>failed_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_gears identifier id'>gears</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

    <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_dup identifier id'>dup</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
      <span class='rubyid_begin begin kw'>begin</span>
        <span class='rubyid_retval identifier id'>retval</span> <span class='assign token'>=</span> <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
        <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:return</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_retval identifier id'>retval</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
      <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_message identifier id'>message</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_backtrace identifier id'>backtrace</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
        <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='notop op'>!</span><span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_OOException constant id'>OOException</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span><span class='rparen token'>)</span>
          <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_append identifier id'>append</span><span class='lparen token'>(</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span>
          <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_Exception constant id'>Exception</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:successful</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span> <span class='symbol val'>:failed</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='lbrack token'>[</span><span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span><span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='rbrack token'>]</span>
  <span class='rubyid_end end kw'>end</span> 

  <span class='rubyid_private identifier id'>private</span>
 
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='rubyid_attr identifier id'>attr</span><span class='rparen token'>)</span>
    <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
      <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
          <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='rubyid_attr identifier id'>attr</span><span class='rbrack token'>]</span>
          <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_break break kw'>break</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
      <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="application-instance_method">
  
    - (<tt><span class='object_link'><a href="Application.html" title="Application (class)">Application</a></span></tt>) <strong>application</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
That this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span> is part of.
</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Application.html" title="Application (class)">Application</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
that this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span> is part of.
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 16</span>

<span class='rubyid_class class kw'>class</span> <span class='rubyid_GroupInstance constant id'>GroupInstance</span>
  <span class='rubyid_include identifier id'>include</span> <span class='rubyid_Mongoid constant id'>Mongoid</span><span class='colon2 op'>::</span><span class='rubyid_Document constant id'>Document</span>
  <span class='rubyid_embedded_in identifier id'>embedded_in</span> <span class='symbol val'>:application</span><span class='comma token'>,</span> <span class='rubyid_class_name identifier id'>class_name</span><span class='colon op'>:</span> <span class='rubyid_Application constant id'>Application</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
  <span class='rubyid_embeds_many identifier id'>embeds_many</span> <span class='symbol val'>:gears</span><span class='comma token'>,</span> <span class='rubyid_class_name identifier id'>class_name</span><span class='colon op'>:</span> <span class='rubyid_Gear constant id'>Gear</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
  
  <span class='rubyid_attr_accessor identifier id'>attr_accessor</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:max</span>
  
  <span class='comment val'># Initializes the application</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># custom_id::</span>
  <span class='comment val'>#   Specify a Moped::BSON::ObjectId to identify this instance</span>
  <span class='comment val'># app_dns::</span>
  <span class='comment val'>#   Specified that this group instance hosts the primary application DNS endpoint.</span>
  <span class='comment val'>#   @Note used when this gear is hosting the web_proxy component</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='assign token'>=</span> <span class='rubyid_attrs identifier id'>attrs</span><span class='lbrack token'>[</span><span class='symbol val'>:custom_id</span><span class='rbrack token'>]</span>
    <span class='rubyid_attrs identifier id'>attrs</span><span class='dot token'>.</span><span class='rubyid_delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:custom_id</span><span class='rparen token'>)</span>
    <span class='rubyid_super super kw'>super</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span> <span class='assign token'>=</span> <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_custom_id identifier id'>custom_id</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_component_instances identifier id'>component_instances</span>
    <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='notop op'>!</span><span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_singleton_instances identifier id'>singleton_instances</span>
    <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span>
    <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='dot token'>.</span><span class='rubyid_where identifier id'>where</span><span class='lparen token'>(</span><span class='rubyid_group_instance_id identifier id'>group_instance_id</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size identifier id'>gear_size</span>
    <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;gear_size&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_default_gear_size identifier id'>default_gear_size</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size= identifier id'>gear_size=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;gear_size&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span>
    <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb= identifier id'>addtl_fs_gb=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Adds ssh keys to all gears within the group instance.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># add_keys::</span>
  <span class='comment val'>#   Array of Hash containing name, type, content of the ssh keys</span>
  <span class='comment val'># remove_keys::</span>
  <span class='comment val'>#   Array of Hash containing name, type, content of the ssh keys  </span>
  <span class='comment val'># add_envs::</span>
  <span class='comment val'>#   Array of Hash containing key, value of the environment variables</span>
  <span class='comment val'># remove_envs::</span>
  <span class='comment val'>#   Array of Hash containing key, value of the environment variables</span>
  <span class='comment val'># gears::</span>
  <span class='comment val'>#   List of gears to apply these changes to</span>
  <span class='comment val'>#   @Note Used internally during create/scale-up operations</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_update_configuration identifier id'>update_configuration</span><span class='lparen token'>(</span><span class='rubyid_add_keys identifier id'>add_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_handle identifier id'>handle</span> <span class='assign token'>=</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_create_parallel_job identifier id'>create_parallel_job</span>
    <span class='rubyid_tag identifier id'>tag</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
    
    <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_run_parallel_on_gears identifier id'>run_parallel_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='comma token'>,</span> <span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
      <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_add_authorized_ssh_key_job identifier id'>get_add_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;type&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_remove_authorized_ssh_key_job identifier id'>get_remove_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

      <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_add_job identifier id'>get_env_var_add_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;value&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_remove_job identifier id'>get_env_var_remove_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_ResultIO constant id'>ResultIO</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span>
    <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_get_parallel_run_results identifier id'>get_parallel_run_results</span><span class='lparen token'>(</span><span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_output identifier id'>output</span><span class='comma token'>,</span> <span class='rubyid_status identifier id'>status</span><span class='bitor op'>|</span>
      <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_output identifier id'>output</span>
      <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_exitcode identifier id'>exitcode</span> <span class='assign token'>=</span> <span class='rubyid_status identifier id'>status</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_status identifier id'>status</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
        <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_NodeException constant id'>NodeException</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Error applying settings to gear: #{gear} with status: #{status} and output: #{output}&quot;</span><span class='comma token'>,</span> <span class='integer val'>143</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_result_io identifier id'>result_io</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># @return [Hash] a simplified hash representing this {GroupInstance} object which is used by {Application#compute_diffs}  </span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_to_hash identifier id'>to_hash</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='lbrace token'>{</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='colon op'>:</span> <span class='rubyid_comps identifier id'>comps</span><span class='comma token'>,</span> <span class='rubyid_scale identifier id'>scale</span><span class='colon op'>:</span> <span class='lbrace token'>{</span><span class='rubyid_current identifier id'>current</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span><span class='comma token'>,</span> <span class='rubyid_additional_filesystem_gb identifier id'>additional_filesystem_gb</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span><span class='comma token'>,</span> <span class='rubyid_gear_size identifier id'>gear_size</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gear_size identifier id'>gear_size</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='rubyid__id identifier id'>_id</span><span class='colon op'>:</span> <span class='rubyid__id identifier id'>_id</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_get_group_override identifier id'>get_group_override</span>
    <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
      <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
          <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span>
          <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_break break kw'>break</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
      <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_value identifier id'>value</span> <span class='rubyid_or or kw'>or</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;components&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span><span class='lbrack token'>[</span><span class='symbol val'>:component_instances</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_protected identifier id'>protected</span>
  
  <span class='comment val'># Run an operation on a list of gears on this group instance.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># gears::</span>
  <span class='comment val'>#   Array of {Gear}s to run the operation on</span>
  <span class='comment val'>#</span>
  <span class='comment val'># result_io::</span>
  <span class='comment val'>#   {ResultIO} object to collect stderr/stdout and exitcode from the operation</span>
  <span class='comment val'>#</span>
  <span class='comment val'># fail_fast::</span>
  <span class='comment val'>#   Boolean to indicate if the operation should fail fast and raise an exception on the first failing gear.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># block::</span>
  <span class='comment val'>#   code block to run on all gears.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Returns:</span>
  <span class='comment val'># successful runs::</span>
  <span class='comment val'>#   List of gears where the operation was successful. Each entry is a Hash :gear -&gt; {Gear}, :return -&gt; exitcode of the operation</span>
  <span class='comment val'># failed_runs::</span>
  <span class='comment val'>#   List of gears where the operation was not successful. Each entry is a Hash :gear -&gt; {Gear}, :exception -&gt; exception raised by the operation</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Raises:</span>
  <span class='comment val'># {Exception} if a gear operation fails and fail_fast is true</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_run_on_gears identifier id'>run_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span><span class='assign token'>=</span><span class='rubyid_true true kw'>true</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
    <span class='rubyid_successful_runs identifier id'>successful_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_failed_runs identifier id'>failed_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_gears identifier id'>gears</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

    <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_dup identifier id'>dup</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
      <span class='rubyid_begin begin kw'>begin</span>
        <span class='rubyid_retval identifier id'>retval</span> <span class='assign token'>=</span> <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
        <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:return</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_retval identifier id'>retval</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
      <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_message identifier id'>message</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_backtrace identifier id'>backtrace</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
        <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='notop op'>!</span><span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_OOException constant id'>OOException</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span><span class='rparen token'>)</span>
          <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_append identifier id'>append</span><span class='lparen token'>(</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span>
          <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_Exception constant id'>Exception</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:successful</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span> <span class='symbol val'>:failed</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='lbrack token'>[</span><span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span><span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='rbrack token'>]</span>
  <span class='rubyid_end end kw'>end</span> 

  <span class='rubyid_private identifier id'>private</span>
 
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='rubyid_attr identifier id'>attr</span><span class='rparen token'>)</span>
    <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
      <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
          <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='rubyid_attr identifier id'>attr</span><span class='rbrack token'>]</span>
          <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_break break kw'>break</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
      <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="gears-instance_method">
  
    - (<tt>Array[<span class='object_link'><a href="Gear.html" title="Gear (class)">Gear</a></span>]</tt>) <strong>gears</strong>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
List of gears that are part of this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span>
</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array[<span class='object_link'><a href="Gear.html" title="Gear (class)">Gear</a></span>]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
List of gears that are part of this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span>
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 16</span>

<span class='rubyid_class class kw'>class</span> <span class='rubyid_GroupInstance constant id'>GroupInstance</span>
  <span class='rubyid_include identifier id'>include</span> <span class='rubyid_Mongoid constant id'>Mongoid</span><span class='colon2 op'>::</span><span class='rubyid_Document constant id'>Document</span>
  <span class='rubyid_embedded_in identifier id'>embedded_in</span> <span class='symbol val'>:application</span><span class='comma token'>,</span> <span class='rubyid_class_name identifier id'>class_name</span><span class='colon op'>:</span> <span class='rubyid_Application constant id'>Application</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
  <span class='rubyid_embeds_many identifier id'>embeds_many</span> <span class='symbol val'>:gears</span><span class='comma token'>,</span> <span class='rubyid_class_name identifier id'>class_name</span><span class='colon op'>:</span> <span class='rubyid_Gear constant id'>Gear</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
  
  <span class='rubyid_attr_accessor identifier id'>attr_accessor</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:max</span>
  
  <span class='comment val'># Initializes the application</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># custom_id::</span>
  <span class='comment val'>#   Specify a Moped::BSON::ObjectId to identify this instance</span>
  <span class='comment val'># app_dns::</span>
  <span class='comment val'>#   Specified that this group instance hosts the primary application DNS endpoint.</span>
  <span class='comment val'>#   @Note used when this gear is hosting the web_proxy component</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='assign token'>=</span> <span class='rubyid_attrs identifier id'>attrs</span><span class='lbrack token'>[</span><span class='symbol val'>:custom_id</span><span class='rbrack token'>]</span>
    <span class='rubyid_attrs identifier id'>attrs</span><span class='dot token'>.</span><span class='rubyid_delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:custom_id</span><span class='rparen token'>)</span>
    <span class='rubyid_super super kw'>super</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span> <span class='assign token'>=</span> <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_custom_id identifier id'>custom_id</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_component_instances identifier id'>component_instances</span>
    <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='notop op'>!</span><span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_singleton_instances identifier id'>singleton_instances</span>
    <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span>
    <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='dot token'>.</span><span class='rubyid_where identifier id'>where</span><span class='lparen token'>(</span><span class='rubyid_group_instance_id identifier id'>group_instance_id</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size identifier id'>gear_size</span>
    <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;gear_size&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_default_gear_size identifier id'>default_gear_size</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size= identifier id'>gear_size=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;gear_size&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span>
    <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb= identifier id'>addtl_fs_gb=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Adds ssh keys to all gears within the group instance.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># add_keys::</span>
  <span class='comment val'>#   Array of Hash containing name, type, content of the ssh keys</span>
  <span class='comment val'># remove_keys::</span>
  <span class='comment val'>#   Array of Hash containing name, type, content of the ssh keys  </span>
  <span class='comment val'># add_envs::</span>
  <span class='comment val'>#   Array of Hash containing key, value of the environment variables</span>
  <span class='comment val'># remove_envs::</span>
  <span class='comment val'>#   Array of Hash containing key, value of the environment variables</span>
  <span class='comment val'># gears::</span>
  <span class='comment val'>#   List of gears to apply these changes to</span>
  <span class='comment val'>#   @Note Used internally during create/scale-up operations</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_update_configuration identifier id'>update_configuration</span><span class='lparen token'>(</span><span class='rubyid_add_keys identifier id'>add_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_handle identifier id'>handle</span> <span class='assign token'>=</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_create_parallel_job identifier id'>create_parallel_job</span>
    <span class='rubyid_tag identifier id'>tag</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
    
    <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_run_parallel_on_gears identifier id'>run_parallel_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='comma token'>,</span> <span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
      <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_add_authorized_ssh_key_job identifier id'>get_add_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;type&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_remove_authorized_ssh_key_job identifier id'>get_remove_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

      <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_add_job identifier id'>get_env_var_add_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;value&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_remove_job identifier id'>get_env_var_remove_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_ResultIO constant id'>ResultIO</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span>
    <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_get_parallel_run_results identifier id'>get_parallel_run_results</span><span class='lparen token'>(</span><span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_output identifier id'>output</span><span class='comma token'>,</span> <span class='rubyid_status identifier id'>status</span><span class='bitor op'>|</span>
      <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_output identifier id'>output</span>
      <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_exitcode identifier id'>exitcode</span> <span class='assign token'>=</span> <span class='rubyid_status identifier id'>status</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_status identifier id'>status</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
        <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_NodeException constant id'>NodeException</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Error applying settings to gear: #{gear} with status: #{status} and output: #{output}&quot;</span><span class='comma token'>,</span> <span class='integer val'>143</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_result_io identifier id'>result_io</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># @return [Hash] a simplified hash representing this {GroupInstance} object which is used by {Application#compute_diffs}  </span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_to_hash identifier id'>to_hash</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='lbrace token'>{</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='colon op'>:</span> <span class='rubyid_comps identifier id'>comps</span><span class='comma token'>,</span> <span class='rubyid_scale identifier id'>scale</span><span class='colon op'>:</span> <span class='lbrace token'>{</span><span class='rubyid_current identifier id'>current</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span><span class='comma token'>,</span> <span class='rubyid_additional_filesystem_gb identifier id'>additional_filesystem_gb</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span><span class='comma token'>,</span> <span class='rubyid_gear_size identifier id'>gear_size</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gear_size identifier id'>gear_size</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='rubyid__id identifier id'>_id</span><span class='colon op'>:</span> <span class='rubyid__id identifier id'>_id</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_get_group_override identifier id'>get_group_override</span>
    <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
      <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
          <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span>
          <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_break break kw'>break</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
      <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_value identifier id'>value</span> <span class='rubyid_or or kw'>or</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;components&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span><span class='lbrack token'>[</span><span class='symbol val'>:component_instances</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_protected identifier id'>protected</span>
  
  <span class='comment val'># Run an operation on a list of gears on this group instance.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># gears::</span>
  <span class='comment val'>#   Array of {Gear}s to run the operation on</span>
  <span class='comment val'>#</span>
  <span class='comment val'># result_io::</span>
  <span class='comment val'>#   {ResultIO} object to collect stderr/stdout and exitcode from the operation</span>
  <span class='comment val'>#</span>
  <span class='comment val'># fail_fast::</span>
  <span class='comment val'>#   Boolean to indicate if the operation should fail fast and raise an exception on the first failing gear.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># block::</span>
  <span class='comment val'>#   code block to run on all gears.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Returns:</span>
  <span class='comment val'># successful runs::</span>
  <span class='comment val'>#   List of gears where the operation was successful. Each entry is a Hash :gear -&gt; {Gear}, :return -&gt; exitcode of the operation</span>
  <span class='comment val'># failed_runs::</span>
  <span class='comment val'>#   List of gears where the operation was not successful. Each entry is a Hash :gear -&gt; {Gear}, :exception -&gt; exception raised by the operation</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Raises:</span>
  <span class='comment val'># {Exception} if a gear operation fails and fail_fast is true</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_run_on_gears identifier id'>run_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span><span class='assign token'>=</span><span class='rubyid_true true kw'>true</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
    <span class='rubyid_successful_runs identifier id'>successful_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_failed_runs identifier id'>failed_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_gears identifier id'>gears</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

    <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_dup identifier id'>dup</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
      <span class='rubyid_begin begin kw'>begin</span>
        <span class='rubyid_retval identifier id'>retval</span> <span class='assign token'>=</span> <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
        <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:return</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_retval identifier id'>retval</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
      <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_message identifier id'>message</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_backtrace identifier id'>backtrace</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
        <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='notop op'>!</span><span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_OOException constant id'>OOException</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span><span class='rparen token'>)</span>
          <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_append identifier id'>append</span><span class='lparen token'>(</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span>
          <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_Exception constant id'>Exception</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:successful</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span> <span class='symbol val'>:failed</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='lbrack token'>[</span><span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span><span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='rbrack token'>]</span>
  <span class='rubyid_end end kw'>end</span> 

  <span class='rubyid_private identifier id'>private</span>
 
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='rubyid_attr identifier id'>attr</span><span class='rparen token'>)</span>
    <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
      <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
          <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='rubyid_attr identifier id'>attr</span><span class='rbrack token'>]</span>
          <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_break break kw'>break</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
      <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="max=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="max-instance_method">
  
    - (<tt>Integer</tt>) <strong>max</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Calculated maximum set of gears supported by <span class='object_link'><a href="ComponentInstance.html" title="ComponentInstance (class)">ComponentInstance</a></span>s in the
group.
</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
Calculated maximum set of gears supported by <span class='object_link'><a href="ComponentInstance.html" title="ComponentInstance (class)">ComponentInstance</a></span>s in the
group.
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 16</span>

<span class='rubyid_class class kw'>class</span> <span class='rubyid_GroupInstance constant id'>GroupInstance</span>
  <span class='rubyid_include identifier id'>include</span> <span class='rubyid_Mongoid constant id'>Mongoid</span><span class='colon2 op'>::</span><span class='rubyid_Document constant id'>Document</span>
  <span class='rubyid_embedded_in identifier id'>embedded_in</span> <span class='symbol val'>:application</span><span class='comma token'>,</span> <span class='rubyid_class_name identifier id'>class_name</span><span class='colon op'>:</span> <span class='rubyid_Application constant id'>Application</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
  <span class='rubyid_embeds_many identifier id'>embeds_many</span> <span class='symbol val'>:gears</span><span class='comma token'>,</span> <span class='rubyid_class_name identifier id'>class_name</span><span class='colon op'>:</span> <span class='rubyid_Gear constant id'>Gear</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
  
  <span class='rubyid_attr_accessor identifier id'>attr_accessor</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:max</span>
  
  <span class='comment val'># Initializes the application</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># custom_id::</span>
  <span class='comment val'>#   Specify a Moped::BSON::ObjectId to identify this instance</span>
  <span class='comment val'># app_dns::</span>
  <span class='comment val'>#   Specified that this group instance hosts the primary application DNS endpoint.</span>
  <span class='comment val'>#   @Note used when this gear is hosting the web_proxy component</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='assign token'>=</span> <span class='rubyid_attrs identifier id'>attrs</span><span class='lbrack token'>[</span><span class='symbol val'>:custom_id</span><span class='rbrack token'>]</span>
    <span class='rubyid_attrs identifier id'>attrs</span><span class='dot token'>.</span><span class='rubyid_delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:custom_id</span><span class='rparen token'>)</span>
    <span class='rubyid_super super kw'>super</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span> <span class='assign token'>=</span> <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_custom_id identifier id'>custom_id</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_component_instances identifier id'>component_instances</span>
    <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='notop op'>!</span><span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_singleton_instances identifier id'>singleton_instances</span>
    <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span>
    <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='dot token'>.</span><span class='rubyid_where identifier id'>where</span><span class='lparen token'>(</span><span class='rubyid_group_instance_id identifier id'>group_instance_id</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size identifier id'>gear_size</span>
    <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;gear_size&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_default_gear_size identifier id'>default_gear_size</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size= identifier id'>gear_size=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;gear_size&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span>
    <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb= identifier id'>addtl_fs_gb=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Adds ssh keys to all gears within the group instance.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># add_keys::</span>
  <span class='comment val'>#   Array of Hash containing name, type, content of the ssh keys</span>
  <span class='comment val'># remove_keys::</span>
  <span class='comment val'>#   Array of Hash containing name, type, content of the ssh keys  </span>
  <span class='comment val'># add_envs::</span>
  <span class='comment val'>#   Array of Hash containing key, value of the environment variables</span>
  <span class='comment val'># remove_envs::</span>
  <span class='comment val'>#   Array of Hash containing key, value of the environment variables</span>
  <span class='comment val'># gears::</span>
  <span class='comment val'>#   List of gears to apply these changes to</span>
  <span class='comment val'>#   @Note Used internally during create/scale-up operations</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_update_configuration identifier id'>update_configuration</span><span class='lparen token'>(</span><span class='rubyid_add_keys identifier id'>add_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_handle identifier id'>handle</span> <span class='assign token'>=</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_create_parallel_job identifier id'>create_parallel_job</span>
    <span class='rubyid_tag identifier id'>tag</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
    
    <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_run_parallel_on_gears identifier id'>run_parallel_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='comma token'>,</span> <span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
      <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_add_authorized_ssh_key_job identifier id'>get_add_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;type&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_remove_authorized_ssh_key_job identifier id'>get_remove_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

      <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_add_job identifier id'>get_env_var_add_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;value&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_remove_job identifier id'>get_env_var_remove_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_ResultIO constant id'>ResultIO</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span>
    <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_get_parallel_run_results identifier id'>get_parallel_run_results</span><span class='lparen token'>(</span><span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_output identifier id'>output</span><span class='comma token'>,</span> <span class='rubyid_status identifier id'>status</span><span class='bitor op'>|</span>
      <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_output identifier id'>output</span>
      <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_exitcode identifier id'>exitcode</span> <span class='assign token'>=</span> <span class='rubyid_status identifier id'>status</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_status identifier id'>status</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
        <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_NodeException constant id'>NodeException</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Error applying settings to gear: #{gear} with status: #{status} and output: #{output}&quot;</span><span class='comma token'>,</span> <span class='integer val'>143</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_result_io identifier id'>result_io</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># @return [Hash] a simplified hash representing this {GroupInstance} object which is used by {Application#compute_diffs}  </span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_to_hash identifier id'>to_hash</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='lbrace token'>{</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='colon op'>:</span> <span class='rubyid_comps identifier id'>comps</span><span class='comma token'>,</span> <span class='rubyid_scale identifier id'>scale</span><span class='colon op'>:</span> <span class='lbrace token'>{</span><span class='rubyid_current identifier id'>current</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span><span class='comma token'>,</span> <span class='rubyid_additional_filesystem_gb identifier id'>additional_filesystem_gb</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span><span class='comma token'>,</span> <span class='rubyid_gear_size identifier id'>gear_size</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gear_size identifier id'>gear_size</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='rubyid__id identifier id'>_id</span><span class='colon op'>:</span> <span class='rubyid__id identifier id'>_id</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_get_group_override identifier id'>get_group_override</span>
    <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
      <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
          <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span>
          <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_break break kw'>break</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
      <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_value identifier id'>value</span> <span class='rubyid_or or kw'>or</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;components&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span><span class='lbrack token'>[</span><span class='symbol val'>:component_instances</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_protected identifier id'>protected</span>
  
  <span class='comment val'># Run an operation on a list of gears on this group instance.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># gears::</span>
  <span class='comment val'>#   Array of {Gear}s to run the operation on</span>
  <span class='comment val'>#</span>
  <span class='comment val'># result_io::</span>
  <span class='comment val'>#   {ResultIO} object to collect stderr/stdout and exitcode from the operation</span>
  <span class='comment val'>#</span>
  <span class='comment val'># fail_fast::</span>
  <span class='comment val'>#   Boolean to indicate if the operation should fail fast and raise an exception on the first failing gear.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># block::</span>
  <span class='comment val'>#   code block to run on all gears.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Returns:</span>
  <span class='comment val'># successful runs::</span>
  <span class='comment val'>#   List of gears where the operation was successful. Each entry is a Hash :gear -&gt; {Gear}, :return -&gt; exitcode of the operation</span>
  <span class='comment val'># failed_runs::</span>
  <span class='comment val'>#   List of gears where the operation was not successful. Each entry is a Hash :gear -&gt; {Gear}, :exception -&gt; exception raised by the operation</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Raises:</span>
  <span class='comment val'># {Exception} if a gear operation fails and fail_fast is true</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_run_on_gears identifier id'>run_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span><span class='assign token'>=</span><span class='rubyid_true true kw'>true</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
    <span class='rubyid_successful_runs identifier id'>successful_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_failed_runs identifier id'>failed_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_gears identifier id'>gears</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

    <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_dup identifier id'>dup</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
      <span class='rubyid_begin begin kw'>begin</span>
        <span class='rubyid_retval identifier id'>retval</span> <span class='assign token'>=</span> <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
        <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:return</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_retval identifier id'>retval</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
      <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_message identifier id'>message</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_backtrace identifier id'>backtrace</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
        <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='notop op'>!</span><span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_OOException constant id'>OOException</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span><span class='rparen token'>)</span>
          <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_append identifier id'>append</span><span class='lparen token'>(</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span>
          <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_Exception constant id'>Exception</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:successful</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span> <span class='symbol val'>:failed</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='lbrack token'>[</span><span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span><span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='rbrack token'>]</span>
  <span class='rubyid_end end kw'>end</span> 

  <span class='rubyid_private identifier id'>private</span>
 
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='rubyid_attr identifier id'>attr</span><span class='rparen token'>)</span>
    <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
      <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
          <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='rubyid_attr identifier id'>attr</span><span class='rbrack token'>]</span>
          <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_break break kw'>break</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
      <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="min=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="min-instance_method">
  
    - (<tt>Integer</tt>) <strong>min</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Calculated minimum set of gears supported by <span class='object_link'><a href="ComponentInstance.html" title="ComponentInstance (class)">ComponentInstance</a></span>s in the
group.
</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
Calculated minimum set of gears supported by <span class='object_link'><a href="ComponentInstance.html" title="ComponentInstance (class)">ComponentInstance</a></span>s in the
group.
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 16</span>

<span class='rubyid_class class kw'>class</span> <span class='rubyid_GroupInstance constant id'>GroupInstance</span>
  <span class='rubyid_include identifier id'>include</span> <span class='rubyid_Mongoid constant id'>Mongoid</span><span class='colon2 op'>::</span><span class='rubyid_Document constant id'>Document</span>
  <span class='rubyid_embedded_in identifier id'>embedded_in</span> <span class='symbol val'>:application</span><span class='comma token'>,</span> <span class='rubyid_class_name identifier id'>class_name</span><span class='colon op'>:</span> <span class='rubyid_Application constant id'>Application</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
  <span class='rubyid_embeds_many identifier id'>embeds_many</span> <span class='symbol val'>:gears</span><span class='comma token'>,</span> <span class='rubyid_class_name identifier id'>class_name</span><span class='colon op'>:</span> <span class='rubyid_Gear constant id'>Gear</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
  
  <span class='rubyid_attr_accessor identifier id'>attr_accessor</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:max</span>
  
  <span class='comment val'># Initializes the application</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># custom_id::</span>
  <span class='comment val'>#   Specify a Moped::BSON::ObjectId to identify this instance</span>
  <span class='comment val'># app_dns::</span>
  <span class='comment val'>#   Specified that this group instance hosts the primary application DNS endpoint.</span>
  <span class='comment val'>#   @Note used when this gear is hosting the web_proxy component</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='assign token'>=</span> <span class='rubyid_attrs identifier id'>attrs</span><span class='lbrack token'>[</span><span class='symbol val'>:custom_id</span><span class='rbrack token'>]</span>
    <span class='rubyid_attrs identifier id'>attrs</span><span class='dot token'>.</span><span class='rubyid_delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:custom_id</span><span class='rparen token'>)</span>
    <span class='rubyid_super super kw'>super</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span> <span class='assign token'>=</span> <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_custom_id identifier id'>custom_id</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_component_instances identifier id'>component_instances</span>
    <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='notop op'>!</span><span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_singleton_instances identifier id'>singleton_instances</span>
    <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span>
    <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='dot token'>.</span><span class='rubyid_where identifier id'>where</span><span class='lparen token'>(</span><span class='rubyid_group_instance_id identifier id'>group_instance_id</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size identifier id'>gear_size</span>
    <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;gear_size&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_default_gear_size identifier id'>default_gear_size</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size= identifier id'>gear_size=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;gear_size&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span>
    <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb= identifier id'>addtl_fs_gb=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Adds ssh keys to all gears within the group instance.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># add_keys::</span>
  <span class='comment val'>#   Array of Hash containing name, type, content of the ssh keys</span>
  <span class='comment val'># remove_keys::</span>
  <span class='comment val'>#   Array of Hash containing name, type, content of the ssh keys  </span>
  <span class='comment val'># add_envs::</span>
  <span class='comment val'>#   Array of Hash containing key, value of the environment variables</span>
  <span class='comment val'># remove_envs::</span>
  <span class='comment val'>#   Array of Hash containing key, value of the environment variables</span>
  <span class='comment val'># gears::</span>
  <span class='comment val'>#   List of gears to apply these changes to</span>
  <span class='comment val'>#   @Note Used internally during create/scale-up operations</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_update_configuration identifier id'>update_configuration</span><span class='lparen token'>(</span><span class='rubyid_add_keys identifier id'>add_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_handle identifier id'>handle</span> <span class='assign token'>=</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_create_parallel_job identifier id'>create_parallel_job</span>
    <span class='rubyid_tag identifier id'>tag</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
    
    <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_run_parallel_on_gears identifier id'>run_parallel_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='comma token'>,</span> <span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
      <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_add_authorized_ssh_key_job identifier id'>get_add_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;type&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_remove_authorized_ssh_key_job identifier id'>get_remove_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

      <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_add_job identifier id'>get_env_var_add_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;value&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_remove_job identifier id'>get_env_var_remove_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_ResultIO constant id'>ResultIO</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span>
    <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_get_parallel_run_results identifier id'>get_parallel_run_results</span><span class='lparen token'>(</span><span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_output identifier id'>output</span><span class='comma token'>,</span> <span class='rubyid_status identifier id'>status</span><span class='bitor op'>|</span>
      <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_output identifier id'>output</span>
      <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_exitcode identifier id'>exitcode</span> <span class='assign token'>=</span> <span class='rubyid_status identifier id'>status</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_status identifier id'>status</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
        <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_NodeException constant id'>NodeException</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Error applying settings to gear: #{gear} with status: #{status} and output: #{output}&quot;</span><span class='comma token'>,</span> <span class='integer val'>143</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_result_io identifier id'>result_io</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># @return [Hash] a simplified hash representing this {GroupInstance} object which is used by {Application#compute_diffs}  </span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_to_hash identifier id'>to_hash</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='lbrace token'>{</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='colon op'>:</span> <span class='rubyid_comps identifier id'>comps</span><span class='comma token'>,</span> <span class='rubyid_scale identifier id'>scale</span><span class='colon op'>:</span> <span class='lbrace token'>{</span><span class='rubyid_current identifier id'>current</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span><span class='comma token'>,</span> <span class='rubyid_additional_filesystem_gb identifier id'>additional_filesystem_gb</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span><span class='comma token'>,</span> <span class='rubyid_gear_size identifier id'>gear_size</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gear_size identifier id'>gear_size</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='rubyid__id identifier id'>_id</span><span class='colon op'>:</span> <span class='rubyid__id identifier id'>_id</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_get_group_override identifier id'>get_group_override</span>
    <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
      <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
          <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span>
          <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_break break kw'>break</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
      <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_value identifier id'>value</span> <span class='rubyid_or or kw'>or</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;components&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span><span class='lbrack token'>[</span><span class='symbol val'>:component_instances</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_protected identifier id'>protected</span>
  
  <span class='comment val'># Run an operation on a list of gears on this group instance.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># gears::</span>
  <span class='comment val'>#   Array of {Gear}s to run the operation on</span>
  <span class='comment val'>#</span>
  <span class='comment val'># result_io::</span>
  <span class='comment val'>#   {ResultIO} object to collect stderr/stdout and exitcode from the operation</span>
  <span class='comment val'>#</span>
  <span class='comment val'># fail_fast::</span>
  <span class='comment val'>#   Boolean to indicate if the operation should fail fast and raise an exception on the first failing gear.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># block::</span>
  <span class='comment val'>#   code block to run on all gears.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Returns:</span>
  <span class='comment val'># successful runs::</span>
  <span class='comment val'>#   List of gears where the operation was successful. Each entry is a Hash :gear -&gt; {Gear}, :return -&gt; exitcode of the operation</span>
  <span class='comment val'># failed_runs::</span>
  <span class='comment val'>#   List of gears where the operation was not successful. Each entry is a Hash :gear -&gt; {Gear}, :exception -&gt; exception raised by the operation</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Raises:</span>
  <span class='comment val'># {Exception} if a gear operation fails and fail_fast is true</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_run_on_gears identifier id'>run_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span><span class='assign token'>=</span><span class='rubyid_true true kw'>true</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
    <span class='rubyid_successful_runs identifier id'>successful_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_failed_runs identifier id'>failed_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_gears identifier id'>gears</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

    <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_dup identifier id'>dup</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
      <span class='rubyid_begin begin kw'>begin</span>
        <span class='rubyid_retval identifier id'>retval</span> <span class='assign token'>=</span> <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
        <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:return</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_retval identifier id'>retval</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
      <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_message identifier id'>message</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_backtrace identifier id'>backtrace</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
        <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='notop op'>!</span><span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_OOException constant id'>OOException</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span><span class='rparen token'>)</span>
          <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_append identifier id'>append</span><span class='lparen token'>(</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span>
          <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_Exception constant id'>Exception</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:successful</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span> <span class='symbol val'>:failed</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='lbrack token'>[</span><span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span><span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='rbrack token'>]</span>
  <span class='rubyid_end end kw'>end</span> 

  <span class='rubyid_private identifier id'>private</span>
 
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='rubyid_attr identifier id'>attr</span><span class='rparen token'>)</span>
    <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
      <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
          <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='rubyid_attr identifier id'>attr</span><span class='rbrack token'>]</span>
          <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_break break kw'>break</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
      <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="user_max=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="user_max-instance_method">
  
    - (<tt>Integer</tt>) <strong>user_max</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
User set maximum number of gears.
</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
User set maximum number of gears.
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 16</span>

<span class='rubyid_class class kw'>class</span> <span class='rubyid_GroupInstance constant id'>GroupInstance</span>
  <span class='rubyid_include identifier id'>include</span> <span class='rubyid_Mongoid constant id'>Mongoid</span><span class='colon2 op'>::</span><span class='rubyid_Document constant id'>Document</span>
  <span class='rubyid_embedded_in identifier id'>embedded_in</span> <span class='symbol val'>:application</span><span class='comma token'>,</span> <span class='rubyid_class_name identifier id'>class_name</span><span class='colon op'>:</span> <span class='rubyid_Application constant id'>Application</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
  <span class='rubyid_embeds_many identifier id'>embeds_many</span> <span class='symbol val'>:gears</span><span class='comma token'>,</span> <span class='rubyid_class_name identifier id'>class_name</span><span class='colon op'>:</span> <span class='rubyid_Gear constant id'>Gear</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
  
  <span class='rubyid_attr_accessor identifier id'>attr_accessor</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:max</span>
  
  <span class='comment val'># Initializes the application</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># custom_id::</span>
  <span class='comment val'>#   Specify a Moped::BSON::ObjectId to identify this instance</span>
  <span class='comment val'># app_dns::</span>
  <span class='comment val'>#   Specified that this group instance hosts the primary application DNS endpoint.</span>
  <span class='comment val'>#   @Note used when this gear is hosting the web_proxy component</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='assign token'>=</span> <span class='rubyid_attrs identifier id'>attrs</span><span class='lbrack token'>[</span><span class='symbol val'>:custom_id</span><span class='rbrack token'>]</span>
    <span class='rubyid_attrs identifier id'>attrs</span><span class='dot token'>.</span><span class='rubyid_delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:custom_id</span><span class='rparen token'>)</span>
    <span class='rubyid_super super kw'>super</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span> <span class='assign token'>=</span> <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_custom_id identifier id'>custom_id</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_component_instances identifier id'>component_instances</span>
    <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='notop op'>!</span><span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_singleton_instances identifier id'>singleton_instances</span>
    <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span>
    <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='dot token'>.</span><span class='rubyid_where identifier id'>where</span><span class='lparen token'>(</span><span class='rubyid_group_instance_id identifier id'>group_instance_id</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size identifier id'>gear_size</span>
    <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;gear_size&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_default_gear_size identifier id'>default_gear_size</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size= identifier id'>gear_size=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;gear_size&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span>
    <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb= identifier id'>addtl_fs_gb=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Adds ssh keys to all gears within the group instance.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># add_keys::</span>
  <span class='comment val'>#   Array of Hash containing name, type, content of the ssh keys</span>
  <span class='comment val'># remove_keys::</span>
  <span class='comment val'>#   Array of Hash containing name, type, content of the ssh keys  </span>
  <span class='comment val'># add_envs::</span>
  <span class='comment val'>#   Array of Hash containing key, value of the environment variables</span>
  <span class='comment val'># remove_envs::</span>
  <span class='comment val'>#   Array of Hash containing key, value of the environment variables</span>
  <span class='comment val'># gears::</span>
  <span class='comment val'>#   List of gears to apply these changes to</span>
  <span class='comment val'>#   @Note Used internally during create/scale-up operations</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_update_configuration identifier id'>update_configuration</span><span class='lparen token'>(</span><span class='rubyid_add_keys identifier id'>add_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_handle identifier id'>handle</span> <span class='assign token'>=</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_create_parallel_job identifier id'>create_parallel_job</span>
    <span class='rubyid_tag identifier id'>tag</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
    
    <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_run_parallel_on_gears identifier id'>run_parallel_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='comma token'>,</span> <span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
      <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_add_authorized_ssh_key_job identifier id'>get_add_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;type&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_remove_authorized_ssh_key_job identifier id'>get_remove_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

      <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_add_job identifier id'>get_env_var_add_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;value&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_remove_job identifier id'>get_env_var_remove_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_ResultIO constant id'>ResultIO</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span>
    <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_get_parallel_run_results identifier id'>get_parallel_run_results</span><span class='lparen token'>(</span><span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_output identifier id'>output</span><span class='comma token'>,</span> <span class='rubyid_status identifier id'>status</span><span class='bitor op'>|</span>
      <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_output identifier id'>output</span>
      <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_exitcode identifier id'>exitcode</span> <span class='assign token'>=</span> <span class='rubyid_status identifier id'>status</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_status identifier id'>status</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
        <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_NodeException constant id'>NodeException</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Error applying settings to gear: #{gear} with status: #{status} and output: #{output}&quot;</span><span class='comma token'>,</span> <span class='integer val'>143</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_result_io identifier id'>result_io</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># @return [Hash] a simplified hash representing this {GroupInstance} object which is used by {Application#compute_diffs}  </span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_to_hash identifier id'>to_hash</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='lbrace token'>{</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='colon op'>:</span> <span class='rubyid_comps identifier id'>comps</span><span class='comma token'>,</span> <span class='rubyid_scale identifier id'>scale</span><span class='colon op'>:</span> <span class='lbrace token'>{</span><span class='rubyid_current identifier id'>current</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span><span class='comma token'>,</span> <span class='rubyid_additional_filesystem_gb identifier id'>additional_filesystem_gb</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span><span class='comma token'>,</span> <span class='rubyid_gear_size identifier id'>gear_size</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gear_size identifier id'>gear_size</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='rubyid__id identifier id'>_id</span><span class='colon op'>:</span> <span class='rubyid__id identifier id'>_id</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_get_group_override identifier id'>get_group_override</span>
    <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
      <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
          <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span>
          <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_break break kw'>break</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
      <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_value identifier id'>value</span> <span class='rubyid_or or kw'>or</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;components&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span><span class='lbrack token'>[</span><span class='symbol val'>:component_instances</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_protected identifier id'>protected</span>
  
  <span class='comment val'># Run an operation on a list of gears on this group instance.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># gears::</span>
  <span class='comment val'>#   Array of {Gear}s to run the operation on</span>
  <span class='comment val'>#</span>
  <span class='comment val'># result_io::</span>
  <span class='comment val'>#   {ResultIO} object to collect stderr/stdout and exitcode from the operation</span>
  <span class='comment val'>#</span>
  <span class='comment val'># fail_fast::</span>
  <span class='comment val'>#   Boolean to indicate if the operation should fail fast and raise an exception on the first failing gear.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># block::</span>
  <span class='comment val'>#   code block to run on all gears.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Returns:</span>
  <span class='comment val'># successful runs::</span>
  <span class='comment val'>#   List of gears where the operation was successful. Each entry is a Hash :gear -&gt; {Gear}, :return -&gt; exitcode of the operation</span>
  <span class='comment val'># failed_runs::</span>
  <span class='comment val'>#   List of gears where the operation was not successful. Each entry is a Hash :gear -&gt; {Gear}, :exception -&gt; exception raised by the operation</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Raises:</span>
  <span class='comment val'># {Exception} if a gear operation fails and fail_fast is true</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_run_on_gears identifier id'>run_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span><span class='assign token'>=</span><span class='rubyid_true true kw'>true</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
    <span class='rubyid_successful_runs identifier id'>successful_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_failed_runs identifier id'>failed_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_gears identifier id'>gears</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

    <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_dup identifier id'>dup</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
      <span class='rubyid_begin begin kw'>begin</span>
        <span class='rubyid_retval identifier id'>retval</span> <span class='assign token'>=</span> <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
        <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:return</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_retval identifier id'>retval</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
      <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_message identifier id'>message</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_backtrace identifier id'>backtrace</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
        <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='notop op'>!</span><span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_OOException constant id'>OOException</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span><span class='rparen token'>)</span>
          <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_append identifier id'>append</span><span class='lparen token'>(</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span>
          <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_Exception constant id'>Exception</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:successful</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span> <span class='symbol val'>:failed</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='lbrack token'>[</span><span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span><span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='rbrack token'>]</span>
  <span class='rubyid_end end kw'>end</span> 

  <span class='rubyid_private identifier id'>private</span>
 
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='rubyid_attr identifier id'>attr</span><span class='rparen token'>)</span>
    <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
      <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
          <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='rubyid_attr identifier id'>attr</span><span class='rbrack token'>]</span>
          <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_break break kw'>break</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
      <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="user_min=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="user_min-instance_method">
  
    - (<tt>Integer</tt>) <strong>user_min</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
User set minimum number of gears.
</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
User set minimum number of gears.
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 16</span>

<span class='rubyid_class class kw'>class</span> <span class='rubyid_GroupInstance constant id'>GroupInstance</span>
  <span class='rubyid_include identifier id'>include</span> <span class='rubyid_Mongoid constant id'>Mongoid</span><span class='colon2 op'>::</span><span class='rubyid_Document constant id'>Document</span>
  <span class='rubyid_embedded_in identifier id'>embedded_in</span> <span class='symbol val'>:application</span><span class='comma token'>,</span> <span class='rubyid_class_name identifier id'>class_name</span><span class='colon op'>:</span> <span class='rubyid_Application constant id'>Application</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
  <span class='rubyid_embeds_many identifier id'>embeds_many</span> <span class='symbol val'>:gears</span><span class='comma token'>,</span> <span class='rubyid_class_name identifier id'>class_name</span><span class='colon op'>:</span> <span class='rubyid_Gear constant id'>Gear</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
  
  <span class='rubyid_attr_accessor identifier id'>attr_accessor</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:max</span>
  
  <span class='comment val'># Initializes the application</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># custom_id::</span>
  <span class='comment val'>#   Specify a Moped::BSON::ObjectId to identify this instance</span>
  <span class='comment val'># app_dns::</span>
  <span class='comment val'>#   Specified that this group instance hosts the primary application DNS endpoint.</span>
  <span class='comment val'>#   @Note used when this gear is hosting the web_proxy component</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='assign token'>=</span> <span class='rubyid_attrs identifier id'>attrs</span><span class='lbrack token'>[</span><span class='symbol val'>:custom_id</span><span class='rbrack token'>]</span>
    <span class='rubyid_attrs identifier id'>attrs</span><span class='dot token'>.</span><span class='rubyid_delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:custom_id</span><span class='rparen token'>)</span>
    <span class='rubyid_super super kw'>super</span><span class='lparen token'>(</span><span class='rubyid_attrs identifier id'>attrs</span><span class='comma token'>,</span> <span class='rubyid_options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span> <span class='assign token'>=</span> <span class='rubyid_custom_id identifier id'>custom_id</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_custom_id identifier id'>custom_id</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_component_instances identifier id'>component_instances</span>
    <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='notop op'>!</span><span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_singleton_instances identifier id'>singleton_instances</span>
    <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span>
    <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='dot token'>.</span><span class='rubyid_where identifier id'>where</span><span class='lparen token'>(</span><span class='rubyid_group_instance_id identifier id'>group_instance_id</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
  
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size identifier id'>gear_size</span>
    <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;gear_size&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_default_gear_size identifier id'>default_gear_size</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size= identifier id'>gear_size=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;gear_size&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span>
    <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb= identifier id'>addtl_fs_gb=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># Adds ssh keys to all gears within the group instance.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># add_keys::</span>
  <span class='comment val'>#   Array of Hash containing name, type, content of the ssh keys</span>
  <span class='comment val'># remove_keys::</span>
  <span class='comment val'>#   Array of Hash containing name, type, content of the ssh keys  </span>
  <span class='comment val'># add_envs::</span>
  <span class='comment val'>#   Array of Hash containing key, value of the environment variables</span>
  <span class='comment val'># remove_envs::</span>
  <span class='comment val'>#   Array of Hash containing key, value of the environment variables</span>
  <span class='comment val'># gears::</span>
  <span class='comment val'>#   List of gears to apply these changes to</span>
  <span class='comment val'>#   @Note Used internally during create/scale-up operations</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_update_configuration identifier id'>update_configuration</span><span class='lparen token'>(</span><span class='rubyid_add_keys identifier id'>add_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='rubyid_handle identifier id'>handle</span> <span class='assign token'>=</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_create_parallel_job identifier id'>create_parallel_job</span>
    <span class='rubyid_tag identifier id'>tag</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
    
    <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_run_parallel_on_gears identifier id'>run_parallel_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='comma token'>,</span> <span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
      <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_add_authorized_ssh_key_job identifier id'>get_add_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;type&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_remove_authorized_ssh_key_job identifier id'>get_remove_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

      <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_add_job identifier id'>get_env_var_add_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;value&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_remove_job identifier id'>get_env_var_remove_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_ResultIO constant id'>ResultIO</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span>
    <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_get_parallel_run_results identifier id'>get_parallel_run_results</span><span class='lparen token'>(</span><span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_output identifier id'>output</span><span class='comma token'>,</span> <span class='rubyid_status identifier id'>status</span><span class='bitor op'>|</span>
      <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_output identifier id'>output</span>
      <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_exitcode identifier id'>exitcode</span> <span class='assign token'>=</span> <span class='rubyid_status identifier id'>status</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_status identifier id'>status</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
        <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_NodeException constant id'>NodeException</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Error applying settings to gear: #{gear} with status: #{status} and output: #{output}&quot;</span><span class='comma token'>,</span> <span class='integer val'>143</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_result_io identifier id'>result_io</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='comment val'># @return [Hash] a simplified hash representing this {GroupInstance} object which is used by {Application#compute_diffs}  </span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_to_hash identifier id'>to_hash</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='lbrace token'>{</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='colon op'>:</span> <span class='rubyid_comps identifier id'>comps</span><span class='comma token'>,</span> <span class='rubyid_scale identifier id'>scale</span><span class='colon op'>:</span> <span class='lbrace token'>{</span><span class='rubyid_current identifier id'>current</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span><span class='comma token'>,</span> <span class='rubyid_additional_filesystem_gb identifier id'>additional_filesystem_gb</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span><span class='comma token'>,</span> <span class='rubyid_gear_size identifier id'>gear_size</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gear_size identifier id'>gear_size</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='rubyid__id identifier id'>_id</span><span class='colon op'>:</span> <span class='rubyid__id identifier id'>_id</span><span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_def def kw'>def</span> <span class='rubyid_get_group_override identifier id'>get_group_override</span>
    <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
      <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
          <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span>
          <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_break break kw'>break</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
      <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_value identifier id'>value</span> <span class='rubyid_or or kw'>or</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;components&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span><span class='lbrack token'>[</span><span class='symbol val'>:component_instances</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_protected identifier id'>protected</span>
  
  <span class='comment val'># Run an operation on a list of gears on this group instance.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Parameters:</span>
  <span class='comment val'># gears::</span>
  <span class='comment val'>#   Array of {Gear}s to run the operation on</span>
  <span class='comment val'>#</span>
  <span class='comment val'># result_io::</span>
  <span class='comment val'>#   {ResultIO} object to collect stderr/stdout and exitcode from the operation</span>
  <span class='comment val'>#</span>
  <span class='comment val'># fail_fast::</span>
  <span class='comment val'>#   Boolean to indicate if the operation should fail fast and raise an exception on the first failing gear.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># block::</span>
  <span class='comment val'>#   code block to run on all gears.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Returns:</span>
  <span class='comment val'># successful runs::</span>
  <span class='comment val'>#   List of gears where the operation was successful. Each entry is a Hash :gear -&gt; {Gear}, :return -&gt; exitcode of the operation</span>
  <span class='comment val'># failed_runs::</span>
  <span class='comment val'>#   List of gears where the operation was not successful. Each entry is a Hash :gear -&gt; {Gear}, :exception -&gt; exception raised by the operation</span>
  <span class='comment val'>#</span>
  <span class='comment val'># == Raises:</span>
  <span class='comment val'># {Exception} if a gear operation fails and fail_fast is true</span>
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_run_on_gears identifier id'>run_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span><span class='assign token'>=</span><span class='rubyid_true true kw'>true</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
    <span class='rubyid_successful_runs identifier id'>successful_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_failed_runs identifier id'>failed_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='rubyid_gears identifier id'>gears</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

    <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_dup identifier id'>dup</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
      <span class='rubyid_begin begin kw'>begin</span>
        <span class='rubyid_retval identifier id'>retval</span> <span class='assign token'>=</span> <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
        <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:return</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_retval identifier id'>retval</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
      <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_message identifier id'>message</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
        <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_backtrace identifier id'>backtrace</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
        <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='notop op'>!</span><span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_OOException constant id'>OOException</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span><span class='rparen token'>)</span>
          <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_append identifier id'>append</span><span class='lparen token'>(</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span>
          <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_Exception constant id'>Exception</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:successful</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span> <span class='symbol val'>:failed</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='lbrack token'>[</span><span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span><span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='rbrack token'>]</span>
  <span class='rubyid_end end kw'>end</span> 

  <span class='rubyid_private identifier id'>private</span>
 
  <span class='rubyid_def def kw'>def</span> <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='rubyid_attr identifier id'>attr</span><span class='rparen token'>)</span>
    <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
    <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
    <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
      <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
      <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
          <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='rubyid_attr identifier id'>attr</span><span class='rbrack token'>]</span>
          <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
          <span class='rubyid_break break kw'>break</span>
        <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
      <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_value identifier id'>value</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="run_on_gears-class_method">
  
    + (<tt>Object</tt>) <strong>run_on_gears</strong>(gears = nil, result_io = nil, fail_fast = true, &amp;block)  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Run an operation on a list of gears on this group instance.
</p>
<h2>Parameters:</h2>
<table>
<tr><td valign="top">gears:</td><td>Array of <span class='object_link'><a href="Gear.html" title="Gear (class)">Gear</a></span>s to run the operation on

</td></tr>
<tr><td valign="top">result_io:</td><td><span class='object_link'><a href="ResultIO.html" title="ResultIO (class)">ResultIO</a></span> object to collect stderr/stdout and exitcode from the operation

</td></tr>
<tr><td valign="top">fail_fast:</td><td>Boolean to indicate if the operation should fail fast and raise an
exception on the first failing gear.

</td></tr>
<tr><td valign="top">block:</td><td>code block to run on all gears.

</td></tr>
</table>
<h2>Returns:</h2>
<table>
<tr><td valign="top">successful runs:</td><td>List of gears where the operation was successful. Each entry is a Hash
:gear -&gt; <span class='object_link'><a href="Gear.html" title="Gear (class)">Gear</a></span>, :return -&gt; exitcode of the operation

</td></tr>
<tr><td valign="top">failed_runs:</td><td>List of gears where the operation was not successful. Each entry is a Hash
:gear -&gt; <span class='object_link'><a href="Gear.html" title="Gear (class)">Gear</a></span>, :exception -&gt; exception raised by the operation

</td></tr>
</table>
<h2>Raises:</h2>
<p>
Exception if a gear operation fails and fail_fast is true
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 150</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_run_on_gears identifier id'>run_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span><span class='assign token'>=</span><span class='rubyid_true true kw'>true</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='rubyid_block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='rubyid_successful_runs identifier id'>successful_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='rubyid_failed_runs identifier id'>failed_runs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='rubyid_gears identifier id'>gears</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

  <span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_dup identifier id'>dup</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
    <span class='rubyid_begin begin kw'>begin</span>
      <span class='rubyid_retval identifier id'>retval</span> <span class='assign token'>=</span> <span class='rubyid_block identifier id'>block</span><span class='dot token'>.</span><span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
      <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:return</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_retval identifier id'>retval</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
    <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
      <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_message identifier id'>message</span>
      <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
      <span class='rubyid_Rails constant id'>Rails</span><span class='dot token'>.</span><span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_backtrace identifier id'>backtrace</span><span class='dot token'>.</span><span class='rubyid_inspect identifier id'>inspect</span>
      <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:gear</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
      <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='notop op'>!</span><span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_OOException constant id'>OOException</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span><span class='rparen token'>)</span>
        <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_append identifier id'>append</span><span class='lparen token'>(</span><span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_fail_fast identifier id'>fail_fast</span>
        <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_Exception constant id'>Exception</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:successful</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span> <span class='symbol val'>:failed</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='comma token'>,</span> <span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='lbrack token'>[</span><span class='rubyid_successful_runs identifier id'>successful_runs</span><span class='comma token'>,</span><span class='rubyid_failed_runs identifier id'>failed_runs</span><span class='rbrack token'>]</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_configuration-class_method">
  
    + (<tt>Object</tt>) <strong>update_configuration</strong>(add_keys = [], remove_keys = [], add_envs = [], remove_envs = [], gears = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Adds ssh keys to all gears within the group instance.
</p>
<h2>Parameters:</h2>
<table>
<tr><td valign="top">add_keys:</td><td>Array of Hash containing name, type, content of the ssh keys

</td></tr>
<tr><td valign="top">remove_keys:</td><td>Array of Hash containing name, type, content of the ssh keys

</td></tr>
<tr><td valign="top">add_envs:</td><td>Array of Hash containing key, value of the environment variables

</td></tr>
<tr><td valign="top">remove_envs:</td><td>Array of Hash containing key, value of the environment variables

</td></tr>
<tr><td valign="top">gears:</td><td>List of gears to apply these changes to @Note Used internally during
create/scale-up operations

</td></tr>
</table>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 80</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_update_configuration identifier id'>update_configuration</span><span class='lparen token'>(</span><span class='rubyid_add_keys identifier id'>add_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_gears identifier id'>gears</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rubyid_handle identifier id'>handle</span> <span class='assign token'>=</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_create_parallel_job identifier id'>create_parallel_job</span>
  <span class='rubyid_tag identifier id'>tag</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
  
  <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_run_parallel_on_gears identifier id'>run_parallel_on_gears</span><span class='lparen token'>(</span><span class='rubyid_gears identifier id'>gears</span><span class='comma token'>,</span> <span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='bitor op'>|</span>
    <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_add_authorized_ssh_key_job identifier id'>get_add_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;type&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_keys identifier id'>add_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='bitor op'>|</span> <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_remove_authorized_ssh_key_job identifier id'>get_remove_authorized_ssh_key_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;content&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_ssh_key identifier id'>ssh_key</span><span class='lbrack token'>[</span><span class='string val'>&quot;name&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_keys identifier id'>remove_keys</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>

    <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>     <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_add_job identifier id'>get_env_var_add_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;value&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_add_envs identifier id'>add_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span>  <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_env identifier id'>env</span><span class='bitor op'>|</span>      <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_add_parallel_job identifier id'>add_parallel_job</span><span class='lparen token'>(</span><span class='rubyid_exec_handle identifier id'>exec_handle</span><span class='comma token'>,</span> <span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='dot token'>.</span><span class='rubyid_get_proxy identifier id'>get_proxy</span><span class='dot token'>.</span><span class='rubyid_get_env_var_remove_job identifier id'>get_env_var_remove_job</span><span class='lparen token'>(</span><span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_env identifier id'>env</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rbrace token'>}</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_remove_envs identifier id'>remove_envs</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_result_io identifier id'>result_io</span> <span class='assign token'>=</span> <span class='rubyid_ResultIO constant id'>ResultIO</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span>
  <span class='rubyid_RemoteJob constant id'>RemoteJob</span><span class='dot token'>.</span><span class='rubyid_get_parallel_run_results identifier id'>get_parallel_run_results</span><span class='lparen token'>(</span><span class='rubyid_handle identifier id'>handle</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_tag identifier id'>tag</span><span class='comma token'>,</span> <span class='rubyid_gear identifier id'>gear</span><span class='comma token'>,</span> <span class='rubyid_output identifier id'>output</span><span class='comma token'>,</span> <span class='rubyid_status identifier id'>status</span><span class='bitor op'>|</span>
    <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_output identifier id'>output</span>
    <span class='rubyid_result_io identifier id'>result_io</span><span class='dot token'>.</span><span class='rubyid_exitcode identifier id'>exitcode</span> <span class='assign token'>=</span> <span class='rubyid_status identifier id'>status</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_status identifier id'>status</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
      <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_NodeException constant id'>NodeException</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Error applying settings to gear: #{gear} with status: #{status} and output: #{output}&quot;</span><span class='comma token'>,</span> <span class='integer val'>143</span><span class='comma token'>,</span> <span class='rubyid_result_io identifier id'>result_io</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_result_io identifier id'>result_io</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="addtl_fs_gb-instance_method">
  
    - (<tt>Object</tt>) <strong>addtl_fs_gb</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


58
59
60</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 58</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span>
  <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="addtl_fs_gb=-instance_method">
  
    - (<tt>Object</tt>) <strong>addtl_fs_gb=</strong>(value) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 62</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_addtl_fs_gb= identifier id'>addtl_fs_gb=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;additional_filesystem_gb&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="all_component_instances-instance_method">
  
    - (<tt>Object</tt>) <strong>all_component_instances</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 46</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span>
  <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='dot token'>.</span><span class='rubyid_where identifier id'>where</span><span class='lparen token'>(</span><span class='rubyid_group_instance_id identifier id'>group_instance_id</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid__id identifier id'>_id</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="component_instances-instance_method">
  
    - (<tt>Object</tt>) <strong>component_instances</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 38</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_component_instances identifier id'>component_instances</span>
  <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='notop op'>!</span><span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="gear_size-instance_method">
  
    - (<tt>Object</tt>) <strong>gear_size</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 50</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size identifier id'>gear_size</span>
  <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='string val'>&quot;gear_size&quot;</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_default_gear_size identifier id'>default_gear_size</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="gear_size=-instance_method">
  
    - (<tt>Object</tt>) <strong>gear_size=</strong>(value) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


54
55
56</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 54</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_gear_size= identifier id'>gear_size=</span><span class='lparen token'>(</span><span class='rubyid_value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='rubyid_get_group_override identifier id'>get_group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;gear_size&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_value identifier id'>value</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_attribute_value-instance_method">
  
    - (<tt>Object</tt>) <strong>get_attribute_value</strong>(attr)  <span class="extras">(private)</span>
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 177</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_get_attribute_value identifier id'>get_attribute_value</span><span class='lparen token'>(</span><span class='rubyid_attr identifier id'>attr</span><span class='rparen token'>)</span>
  <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
  <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
  <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
    <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
    <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
        <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='rubyid_attr identifier id'>attr</span><span class='rbrack token'>]</span>
        <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
        <span class='rubyid_break break kw'>break</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
    <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_value identifier id'>value</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_group_override-instance_method">
  
    - (<tt>Object</tt>) <strong>get_group_override</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 108</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_get_group_override identifier id'>get_group_override</span>
  <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span>
  <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
  <span class='rubyid_comps identifier id'>comps</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_comp identifier id'>comp</span><span class='bitor op'>|</span>
    <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>
    <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_group_override identifier id'>group_override</span><span class='bitor op'>|</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_group_override identifier id'>group_override</span><span class='lbrack token'>[</span><span class='string val'>&quot;components&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_comp identifier id'>comp</span><span class='rparen token'>)</span>
        <span class='rubyid_value identifier id'>value</span> <span class='assign token'>=</span> <span class='rubyid_group_override identifier id'>group_override</span>
        <span class='rubyid_found identifier id'>found</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
        <span class='rubyid_break break kw'>break</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_group_overrides identifier id'>group_overrides</span>
    <span class='rubyid_break break kw'>break</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_found identifier id'>found</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_value identifier id'>value</span> <span class='rubyid_or or kw'>or</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;components&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span><span class='lbrack token'>[</span><span class='symbol val'>:component_instances</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="singleton_instances-instance_method">
  
    - (<tt>Object</tt>) <strong>singleton_instances</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


42
43
44</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 42</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_singleton_instances identifier id'>singleton_instances</span>
  <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_is_singleton? fid id'>is_singleton?</span><span class='rbrace token'>}</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_hash-instance_method">
  
    - (<tt>Hash</tt>) <strong>to_hash</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
A simplified hash representing this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span> object which is used by
<span class='object_link'><a href="Application.html#compute_diffs-instance_method" title="Application#compute_diffs (method)">Application#compute_diffs</a></span>
</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
a simplified hash representing this <span class='object_link'><a href="" title="GroupInstance (class)">GroupInstance</a></span> object which is used by
<span class='object_link'><a href="Application.html#compute_diffs-instance_method" title="Application#compute_diffs (method)">Application#compute_diffs</a></span>
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103
104
105
106</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/models/group_instance.rb', line 103</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_to_hash identifier id'>to_hash</span>
  <span class='rubyid_comps identifier id'>comps</span> <span class='assign token'>=</span> <span class='rubyid_all_component_instances identifier id'>all_component_instances</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_to_hash identifier id'>to_hash</span> <span class='rbrace token'>}</span>
  <span class='lbrace token'>{</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='colon op'>:</span> <span class='rubyid_comps identifier id'>comps</span><span class='comma token'>,</span> <span class='rubyid_scale identifier id'>scale</span><span class='colon op'>:</span> <span class='lbrace token'>{</span><span class='rubyid_current identifier id'>current</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gears identifier id'>gears</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span><span class='comma token'>,</span> <span class='rubyid_additional_filesystem_gb identifier id'>additional_filesystem_gb</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_addtl_fs_gb identifier id'>addtl_fs_gb</span><span class='comma token'>,</span> <span class='rubyid_gear_size identifier id'>gear_size</span><span class='colon op'>:</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_gear_size identifier id'>gear_size</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='rubyid__id identifier id'>_id</span><span class='colon op'>:</span> <span class='rubyid__id identifier id'>_id</span><span class='rbrace token'>}</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Sun Apr  7 18:17:08 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-1.8.7).
</div>

  </body>
</html>