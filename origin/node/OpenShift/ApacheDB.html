<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: OpenShift::ApacheDB
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../OpenShift.html" title="OpenShift (module)">OpenShift</a></span></span>
     &raquo; 
    <span class="title">ApacheDB</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: OpenShift::ApacheDB
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Hash</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Hash</li>
          
            <li class="next">OpenShift::ApacheDB</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="NodeLogger.html" title="OpenShift::NodeLogger (module)">NodeLogger</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">origin-server/node/lib/openshift-origin-node/model/frontend_httpd.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
Present an API to Apache&#8217;s DB files for mod_rewrite.
</p>
<p>
This is a bit complicated since there don&#8217;t appear to be a DB file
format common to ruby and Apache that does not have corruption issues. The
only format they can agree on is text, which is slow for 10&#8217;s of
thousands of entries. Unfortunately, that means we have to go through a
convoluted process to populate the final Apache DB.
</p>
<p>
This locks down to one thread for safety. You MUST ensure that close is
called to release all locks. Close also syncs changes to Apache if data was
modified.
</p>


  </div>
</div>
<div class="tags">
  

</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="ApacheDBAliases.html" title="OpenShift::ApacheDBAliases (class)">ApacheDBAliases</a></span>, <span class='object_link'><a href="ApacheDBIdler.html" title="OpenShift::ApacheDBIdler (class)">ApacheDBIdler</a></span>, <span class='object_link'><a href="ApacheDBJSON.html" title="OpenShift::ApacheDBJSON (class)">ApacheDBJSON</a></span>, <span class='object_link'><a href="ApacheDBNodes.html" title="OpenShift::ApacheDBNodes (class)">ApacheDBNodes</a></span>, <span class='object_link'><a href="ApacheDBSTS.html" title="OpenShift::ApacheDBSTS (class)">ApacheDBSTS</a></span></p>
</div>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="READER-constant" class="">READER =
          
        </dt>
        <dd><pre class="code"><span class='rubyid_Fcntl constant id'>Fcntl</span><span class='colon2 op'>::</span><span class='rubyid_O_RDONLY constant id'>O_RDONLY</span>
</pre></dd>
      
        <dt id="WRITER-constant" class="">WRITER =
          
        </dt>
        <dd><pre class="code"><span class='rubyid_Fcntl constant id'>Fcntl</span><span class='colon2 op'>::</span><span class='rubyid_O_RDWR constant id'>O_RDWR</span>
</pre></dd>
      
        <dt id="WRCREAT-constant" class="">WRCREAT =
          
        </dt>
        <dd><pre class="code"><span class='rubyid_Fcntl constant id'>Fcntl</span><span class='colon2 op'>::</span><span class='rubyid_O_RDWR constant id'>O_RDWR</span> <span class='bitor op'>|</span> <span class='rubyid_Fcntl constant id'>Fcntl</span><span class='colon2 op'>::</span><span class='rubyid_O_CREAT constant id'>O_CREAT</span>
</pre></dd>
      
        <dt id="NEWDB-constant" class="">NEWDB =
          
        </dt>
        <dd><pre class="code"><span class='rubyid_Fcntl constant id'>Fcntl</span><span class='colon2 op'>::</span><span class='rubyid_O_RDWR constant id'>O_RDWR</span> <span class='bitor op'>|</span> <span class='rubyid_Fcntl constant id'>Fcntl</span><span class='colon2 op'>::</span><span class='rubyid_O_CREAT constant id'>O_CREAT</span> <span class='bitor op'>|</span> <span class='rubyid_Fcntl constant id'>Fcntl</span><span class='colon2 op'>::</span><span class='rubyid_O_TRUNC constant id'>O_TRUNC</span>
</pre></dd>
      
        <dt id="LOCKS-classvariable" class="">@@LOCKS =
          <div class="docstring">
  <div class="discussion">
    <p>
The locks and lockfiles are based on the file name
</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='rubyid_Hash constant id'>Hash</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span> <span class='lbrace token'>{</span>
</pre></dd>
      
        <dt id="LOCKFILEBASE-classvariable" class="">@@LOCKFILEBASE =
          
        </dt>
        <dd><pre class="code"><span class='string val'>&quot;/var/run/openshift/ApacheDB&quot;</span>
</pre></dd>
      
    </dl>
  



  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="NodeLogger.html" title="OpenShift::NodeLogger (module)">NodeLogger</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="NodeLogger.html#PROFILES-constant" title="OpenShift::NodeLogger::PROFILES (constant)">NodeLogger::PROFILES</a></span></p>





  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#open-class_method" title="open (class method)">+ (Object) <strong>open</strong>(flags = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Preferred method of access is to feed a block to open so we can guarantee
the close.
</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#callout-instance_method" title="#callout (instance method)">- (Object) <strong>callout</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#close-instance_method" title="#close (instance method)">- (Object) <strong>close</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#closed%3F-instance_method" title="#closed? (instance method)">- (Boolean) <strong>closed?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#decode_contents-instance_method" title="#decode_contents (instance method)">- (Object) <strong>decode_contents</strong>(f) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#encode_contents-instance_method" title="#encode_contents (instance method)">- (Object) <strong>encode_contents</strong>(f) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#flush-instance_method" title="#flush (instance method)">- (Object) <strong>flush</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (ApacheDB) <strong>initialize</strong>(flags = nil) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
A new instance of ApacheDB.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reload-instance_method" title="#reload (instance method)">- (Object) <strong>reload</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_block-instance_method" title="#update_block (instance method)">- (Object) <strong>update_block</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Public, update using a block The block is called for each key, value pair
of the hash and uses the following parameters:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#writable%3F-instance_method" title="#writable? (instance method)">- (Boolean) <strong>writable?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="NodeLogger.html" title="OpenShift::NodeLogger (module)">NodeLogger</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="NodeLogger.html#build_logger-class_method" title="OpenShift::NodeLogger.build_logger (method)">build_logger</a></span>, <span class='object_link'><a href="NodeLogger.html#logger-instance_method" title="OpenShift::NodeLogger#logger (method)">#logger</a></span>, <span class='object_link'><a href="NodeLogger.html#logger-class_method" title="OpenShift::NodeLogger.logger (method)">logger</a></span>, <span class='object_link'><a href="NodeLogger.html#trace_logger-instance_method" title="OpenShift::NodeLogger#trace_logger (method)">#trace_logger</a></span>, <span class='object_link'><a href="NodeLogger.html#trace_logger-class_method" title="OpenShift::NodeLogger.trace_logger (method)">trace_logger</a></span></p>

  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="OpenShift::ApacheDB (class)">ApacheDB</a></span></tt>) <strong>initialize</strong>(flags = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
A new instance of ApacheDB
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880
881
882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/frontend_httpd.rb', line 864</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='rubyid_flags identifier id'>flags</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rubyid_@closed ivar id'>@closed</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_MAPNAME constant id'>MAPNAME</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_NotImplementedError constant id'>NotImplementedError</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;Must subclass with proper map name.&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_@config ivar id'>@config</span> <span class='assign token'>=</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_Config constant id'>Config</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span>
  <span class='rubyid_@basedir ivar id'>@basedir</span> <span class='assign token'>=</span> <span class='rubyid_@config ivar id'>@config</span><span class='dot token'>.</span><span class='rubyid_get identifier id'>get</span><span class='lparen token'>(</span><span class='string val'>&quot;OPENSHIFT_HTTP_CONF_DIR&quot;</span><span class='rparen token'>)</span>

  <span class='rubyid_@mode ivar id'>@mode</span> <span class='assign token'>=</span> <span class='integer val'>0640</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_flags identifier id'>flags</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
    <span class='rubyid_@flags ivar id'>@flags</span> <span class='assign token'>=</span> <span class='rubyid_READER constant id'>READER</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_@flags ivar id'>@flags</span> <span class='assign token'>=</span> <span class='rubyid_flags identifier id'>flags</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_@filename ivar id'>@filename</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_@basedir ivar id'>@basedir</span><span class='comma token'>,</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_MAPNAME constant id'>MAPNAME</span><span class='rparen token'>)</span>

  <span class='rubyid_@lockfile ivar id'>@lockfile</span> <span class='assign token'>=</span> <span class='rubyid_@@LOCKFILEBASE ivar id'>@@LOCKFILEBASE</span> <span class='plus op'>+</span> <span class='string val'>'.'</span> <span class='plus op'>+</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_MAPNAME constant id'>MAPNAME</span> <span class='plus op'>+</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_SUFFIX constant id'>SUFFIX</span> <span class='plus op'>+</span> <span class='string val'>'.lock'</span>

  <span class='rubyid_super super kw'>super</span><span class='lparen token'>(</span><span class='rparen token'>)</span>

  <span class='comment val'># Each filename needs its own mutex and lockfile</span>
  <span class='rubyid_@@LOCKS ivar id'>@@LOCKS</span><span class='lbrack token'>[</span><span class='rubyid_@lockfile ivar id'>@lockfile</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_lock identifier id'>lock</span>

  <span class='rubyid_begin begin kw'>begin</span>
    <span class='rubyid_@lfd ivar id'>@lfd</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_@lockfile ivar id'>@lockfile</span><span class='comma token'>,</span> <span class='rubyid_Fcntl constant id'>Fcntl</span><span class='colon2 op'>::</span><span class='rubyid_O_RDWR constant id'>O_RDWR</span> <span class='bitor op'>|</span> <span class='rubyid_Fcntl constant id'>Fcntl</span><span class='colon2 op'>::</span><span class='rubyid_O_CREAT constant id'>O_CREAT</span><span class='comma token'>,</span> <span class='integer val'>0640</span><span class='rparen token'>)</span>

    <span class='rubyid_if if kw'>if</span> <span class='rubyid_writable? fid id'>writable?</span>
      <span class='rubyid_@lfd ivar id'>@lfd</span><span class='dot token'>.</span><span class='rubyid_flock identifier id'>flock</span><span class='lparen token'>(</span><span class='rubyid_File constant id'>File</span><span class='colon2 op'>::</span><span class='rubyid_LOCK_EX constant id'>LOCK_EX</span><span class='rparen token'>)</span>
    <span class='rubyid_else else kw'>else</span>
      <span class='rubyid_@lfd ivar id'>@lfd</span><span class='dot token'>.</span><span class='rubyid_flock identifier id'>flock</span><span class='lparen token'>(</span><span class='rubyid_File constant id'>File</span><span class='colon2 op'>::</span><span class='rubyid_LOCK_SH constant id'>LOCK_SH</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>

    <span class='rubyid_if if kw'>if</span> <span class='rubyid_@flags ivar id'>@flags</span> <span class='neq op'>!=</span> <span class='rubyid_NEWDB constant id'>NEWDB</span>
      <span class='rubyid_reload identifier id'>reload</span>
    <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_rescue rescue kw'>rescue</span>
    <span class='rubyid_begin begin kw'>begin</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_@lfd ivar id'>@lfd</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
        <span class='rubyid_@lfd ivar id'>@lfd</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_ensure ensure kw'>ensure</span>
      <span class='rubyid_@@LOCKS ivar id'>@@LOCKS</span><span class='lbrack token'>[</span><span class='rubyid_@lockfile ivar id'>@lockfile</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_unlock identifier id'>unlock</span>
    <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_raise identifier id'>raise</span>
  <span class='rubyid_end end kw'>end</span>

<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="open-class_method">
  
    + (<tt>Object</tt>) <strong>open</strong>(flags = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Preferred method of access is to feed a block to open so we can guarantee
the close.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/frontend_httpd.rb', line 1020</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_open identifier id'>open</span><span class='lparen token'>(</span><span class='rubyid_flags identifier id'>flags</span><span class='assign token'>=</span><span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rubyid_inst identifier id'>inst</span> <span class='assign token'>=</span> <span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_flags identifier id'>flags</span><span class='rparen token'>)</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_block_given? fid id'>block_given?</span>
    <span class='rubyid_begin begin kw'>begin</span>
      <span class='rubyid_return return kw'>return</span> <span class='rubyid_yield yield kw'>yield</span><span class='lparen token'>(</span><span class='rubyid_inst identifier id'>inst</span><span class='rparen token'>)</span>
    <span class='rubyid_rescue rescue kw'>rescue</span>
      <span class='rubyid_@flags ivar id'>@flags</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span> <span class='comment val'># Disable flush</span>
      <span class='rubyid_raise identifier id'>raise</span>
    <span class='rubyid_ensure ensure kw'>ensure</span>
      <span class='rubyid_if if kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_inst identifier id'>inst</span><span class='dot token'>.</span><span class='rubyid_closed? fid id'>closed?</span>
        <span class='rubyid_inst identifier id'>inst</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span>
      <span class='rubyid_end end kw'>end</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_inst identifier id'>inst</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="callout-instance_method">
  
    - (<tt>Object</tt>) <strong>callout</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


948
949
950
951
952
953
954
955
956
957
958
959
960
961
962
963
964
965
966
967
968
969
970
971
972
973
974
975
976
977</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/frontend_httpd.rb', line 948</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_callout identifier id'>callout</span>
  <span class='comment val'># Use Berkeley DB so that there's no race condition between</span>
  <span class='comment val'># multiple file moves.  The Berkeley DB implementation creates a</span>
  <span class='comment val'># scratch working file under certain circumstances.  Use a</span>
  <span class='comment val'># scratch dir to protect it.</span>
  <span class='rubyid_Dir constant id'>Dir</span><span class='dot token'>.</span><span class='rubyid_mktmpdir identifier id'>mktmpdir</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_basename identifier id'>basename</span><span class='lparen token'>(</span><span class='rubyid_@filename ivar id'>@filename</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='string val'>&quot;.db-&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='rubyid_@filename ivar id'>@filename</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_wd identifier id'>wd</span><span class='bitor op'>|</span>
    <span class='rubyid_tmpdb identifier id'>tmpdb</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_wd identifier id'>wd</span><span class='comma token'>,</span> <span class='string val'>'new.db'</span><span class='rparen token'>)</span>

    <span class='rubyid_httxt2dbm identifier id'>httxt2dbm</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='string val'>&quot;/usr/bin&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;/usr/sbin&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;/bin&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;/sbin&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_d identifier id'>d</span><span class='bitor op'>|</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_d identifier id'>d</span><span class='comma token'>,</span> <span class='string val'>&quot;httxt2dbm&quot;</span><span class='rparen token'>)</span><span class='rbrace token'>}</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_p identifier id'>p</span><span class='bitor op'>|</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exists? fid id'>exists?</span><span class='lparen token'>(</span><span class='rubyid_p identifier id'>p</span><span class='rparen token'>)</span><span class='rbrace token'>}</span><span class='dot token'>.</span><span class='rubyid_pop identifier id'>pop</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_httxt2dbm identifier id'>httxt2dbm</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
      <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_warn identifier id'>warn</span><span class='lparen token'>(</span><span class='string val'>&quot;WARNING: no httxt2dbm command found, relying on PATH&quot;</span><span class='rparen token'>)</span>
      <span class='rubyid_httxt2dbm identifier id'>httxt2dbm</span><span class='assign token'>=</span><span class='string val'>&quot;httxt2dbm&quot;</span>
    <span class='rubyid_end end kw'>end</span>

    <span class='rubyid_cmd identifier id'>cmd</span> <span class='assign token'>=</span> <span class='dstring node'>%{#{httxt2dbm} -f DB -i #{@filename}#{self.SUFFIX} -o #{tmpdb}}</span>
    <span class='rubyid_out identifier id'>out</span><span class='comma token'>,</span><span class='rubyid_err identifier id'>err</span><span class='comma token'>,</span><span class='rubyid_rc identifier id'>rc</span> <span class='assign token'>=</span> <span class='rubyid_Utils constant id'>Utils</span><span class='colon2 op'>::</span><span class='rubyid_oo_spawn identifier id'>oo_spawn</span><span class='lparen token'>(</span><span class='rubyid_cmd identifier id'>cmd</span><span class='rparen token'>)</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_rc identifier id'>rc</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
      <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_debug identifier id'>debug</span><span class='lparen token'>(</span><span class='dstring node'>&quot;httxt2dbm: #{@filename}: #{rc}: stdout: #{out} stderr:#{err}&quot;</span><span class='rparen token'>)</span>
      <span class='rubyid_begin begin kw'>begin</span>
        <span class='rubyid_oldstat identifier id'>oldstat</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_stat identifier id'>stat</span><span class='lparen token'>(</span><span class='rubyid_@filename ivar id'>@filename</span> <span class='plus op'>+</span> <span class='string val'>'.db'</span><span class='rparen token'>)</span>
        <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_chown identifier id'>chown</span><span class='lparen token'>(</span><span class='rubyid_oldstat identifier id'>oldstat</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='comma token'>,</span> <span class='rubyid_oldstat identifier id'>oldstat</span><span class='dot token'>.</span><span class='rubyid_gid identifier id'>gid</span><span class='comma token'>,</span> <span class='rubyid_tmpdb identifier id'>tmpdb</span><span class='rparen token'>)</span>
        <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_chmod identifier id'>chmod</span><span class='lparen token'>(</span><span class='rubyid_oldstat identifier id'>oldstat</span><span class='dot token'>.</span><span class='rubyid_mode identifier id'>mode</span> <span class='bitand op'>&amp;</span> <span class='integer val'>0777</span><span class='comma token'>,</span> <span class='rubyid_tmpdb identifier id'>tmpdb</span><span class='rparen token'>)</span>
      <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Errno constant id'>Errno</span><span class='colon2 op'>::</span><span class='rubyid_ENOENT constant id'>ENOENT</span>
      <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_mv identifier id'>mv</span><span class='lparen token'>(</span><span class='rubyid_tmpdb identifier id'>tmpdb</span><span class='comma token'>,</span> <span class='rubyid_@filename ivar id'>@filename</span> <span class='plus op'>+</span> <span class='string val'>'.db'</span><span class='comma token'>,</span> <span class='symbol val'>:force=</span><span class='gt op'>&gt;</span><span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span>
    <span class='rubyid_else else kw'>else</span>
      <span class='rubyid_logger identifier id'>logger</span><span class='dot token'>.</span><span class='rubyid_error identifier id'>error</span><span class='lparen token'>(</span><span class='dstring node'>&quot;ERROR: failure httxt2dbm #{@filename}: #{rc}: stdout: #{out} stderr:#{err}&quot;</span><span class='rparen token'>)</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_rc identifier id'>rc</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="close-instance_method">
  
    - (<tt>Object</tt>) <strong>close</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1001
1002
1003
1004
1005
1006
1007
1008
1009
1010
1011
1012</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/frontend_httpd.rb', line 1001</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_close identifier id'>close</span>
  <span class='rubyid_@closed ivar id'>@closed</span><span class='assign token'>=</span><span class='rubyid_true true kw'>true</span>
  <span class='rubyid_begin begin kw'>begin</span>
    <span class='rubyid_begin begin kw'>begin</span>
      <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_flush identifier id'>flush</span>
    <span class='rubyid_ensure ensure kw'>ensure</span>
      <span class='rubyid_@lfd ivar id'>@lfd</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_@lfd ivar id'>@lfd</span><span class='dot token'>.</span><span class='rubyid_closed? fid id'>closed?</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_ensure ensure kw'>ensure</span>
    <span class='rubyid_@@LOCKS ivar id'>@@LOCKS</span><span class='lbrack token'>[</span><span class='rubyid_@lockfile ivar id'>@lockfile</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_unlock identifier id'>unlock</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_@@LOCKS ivar id'>@@LOCKS</span><span class='lbrack token'>[</span><span class='rubyid_@lockfile ivar id'>@lockfile</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_locked? fid id'>locked?</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="closed?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>closed?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1014
1015
1016</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/frontend_httpd.rb', line 1014</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_closed? fid id'>closed?</span>
  <span class='rubyid_@closed ivar id'>@closed</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="decode_contents-instance_method">
  
    - (<tt>Object</tt>) <strong>decode_contents</strong>(f) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


917
918
919
920
921
922
923
924</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/frontend_httpd.rb', line 917</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_decode_contents identifier id'>decode_contents</span><span class='lparen token'>(</span><span class='rubyid_f identifier id'>f</span><span class='rparen token'>)</span>
  <span class='rubyid_f identifier id'>f</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_l identifier id'>l</span><span class='bitor op'>|</span>
    <span class='rubyid_path identifier id'>path</span><span class='comma token'>,</span> <span class='rubyid_dest identifier id'>dest</span> <span class='assign token'>=</span> <span class='rubyid_l identifier id'>l</span><span class='dot token'>.</span><span class='rubyid_strip identifier id'>strip</span><span class='dot token'>.</span><span class='rubyid_split identifier id'>split</span>
    <span class='rubyid_if if kw'>if</span> <span class='lparen token'>(</span><span class='rubyid_not not kw'>not</span> <span class='rubyid_path identifier id'>path</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span><span class='rparen token'>)</span> <span class='rubyid_and and kw'>and</span> <span class='lparen token'>(</span><span class='rubyid_not not kw'>not</span> <span class='rubyid_dest identifier id'>dest</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span><span class='rparen token'>)</span>
      <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_store identifier id'>store</span><span class='lparen token'>(</span><span class='rubyid_path identifier id'>path</span><span class='comma token'>,</span> <span class='rubyid_dest identifier id'>dest</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="encode_contents-instance_method">
  
    - (<tt>Object</tt>) <strong>encode_contents</strong>(f) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


926
927
928
929
930</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/frontend_httpd.rb', line 926</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_encode_contents identifier id'>encode_contents</span><span class='lparen token'>(</span><span class='rubyid_f identifier id'>f</span><span class='rparen token'>)</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_k identifier id'>k</span><span class='comma token'>,</span> <span class='rubyid_v identifier id'>v</span><span class='bitor op'>|</span>
    <span class='rubyid_f identifier id'>f</span><span class='dot token'>.</span><span class='rubyid_write identifier id'>write</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='rubyid_k identifier id'>k</span><span class='comma token'>,</span> <span class='rubyid_v identifier id'>v</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>' '</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='string val'>&quot;\n&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="flush-instance_method">
  
    - (<tt>Object</tt>) <strong>flush</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


979
980
981
982
983
984
985
986
987
988
989
990
991
992
993
994
995
996
997
998
999</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/frontend_httpd.rb', line 979</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_flush identifier id'>flush</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_writable? fid id'>writable?</span>
    <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_open identifier id'>open</span><span class='lparen token'>(</span><span class='rubyid_@filename ivar id'>@filename</span> <span class='plus op'>+</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_SUFFIX constant id'>SUFFIX</span> <span class='plus op'>+</span> <span class='string val'>'-'</span><span class='comma token'>,</span> <span class='rubyid_Fcntl constant id'>Fcntl</span><span class='colon2 op'>::</span><span class='rubyid_O_RDWR constant id'>O_RDWR</span> <span class='bitor op'>|</span> <span class='rubyid_Fcntl constant id'>Fcntl</span><span class='colon2 op'>::</span><span class='rubyid_O_CREAT constant id'>O_CREAT</span> <span class='bitor op'>|</span> <span class='rubyid_Fcntl constant id'>Fcntl</span><span class='colon2 op'>::</span><span class='rubyid_O_TRUNC constant id'>O_TRUNC</span><span class='comma token'>,</span> <span class='integer val'>0640</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_f identifier id'>f</span><span class='bitor op'>|</span>
      <span class='rubyid_encode_contents identifier id'>encode_contents</span><span class='lparen token'>(</span><span class='rubyid_f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>

    <span class='comment val'># Ruby 1.9 Hash preserves order, compare files to see if anything changed</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_compare_file identifier id'>compare_file</span><span class='lparen token'>(</span><span class='rubyid_@filename ivar id'>@filename</span> <span class='plus op'>+</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_SUFFIX constant id'>SUFFIX</span> <span class='plus op'>+</span> <span class='string val'>'-'</span><span class='comma token'>,</span> <span class='rubyid_@filename ivar id'>@filename</span> <span class='plus op'>+</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_SUFFIX constant id'>SUFFIX</span><span class='rparen token'>)</span>
      <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_rm identifier id'>rm</span><span class='lparen token'>(</span><span class='rubyid_@filename ivar id'>@filename</span> <span class='plus op'>+</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_SUFFIX constant id'>SUFFIX</span> <span class='plus op'>+</span> <span class='string val'>'-'</span><span class='comma token'>,</span> <span class='symbol val'>:force=</span><span class='gt op'>&gt;</span><span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span>
    <span class='rubyid_else else kw'>else</span>
      <span class='rubyid_begin begin kw'>begin</span>
        <span class='rubyid_oldstat identifier id'>oldstat</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_stat identifier id'>stat</span><span class='lparen token'>(</span><span class='rubyid_@filename ivar id'>@filename</span> <span class='plus op'>+</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_SUFFIX constant id'>SUFFIX</span><span class='rparen token'>)</span>
        <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_chown identifier id'>chown</span><span class='lparen token'>(</span><span class='rubyid_oldstat identifier id'>oldstat</span><span class='dot token'>.</span><span class='rubyid_uid identifier id'>uid</span><span class='comma token'>,</span> <span class='rubyid_oldstat identifier id'>oldstat</span><span class='dot token'>.</span><span class='rubyid_gid identifier id'>gid</span><span class='comma token'>,</span> <span class='rubyid_@filename ivar id'>@filename</span> <span class='plus op'>+</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_SUFFIX constant id'>SUFFIX</span> <span class='plus op'>+</span> <span class='string val'>'-'</span><span class='rparen token'>)</span>
        <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_chmod identifier id'>chmod</span><span class='lparen token'>(</span><span class='rubyid_oldstat identifier id'>oldstat</span><span class='dot token'>.</span><span class='rubyid_mode identifier id'>mode</span> <span class='bitand op'>&amp;</span> <span class='integer val'>0777</span><span class='comma token'>,</span> <span class='rubyid_@filename ivar id'>@filename</span> <span class='plus op'>+</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_SUFFIX constant id'>SUFFIX</span> <span class='plus op'>+</span> <span class='string val'>'-'</span><span class='rparen token'>)</span>
      <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Errno constant id'>Errno</span><span class='colon2 op'>::</span><span class='rubyid_ENOENT constant id'>ENOENT</span>
      <span class='rubyid_end end kw'>end</span>
      <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_mv identifier id'>mv</span><span class='lparen token'>(</span><span class='rubyid_@filename ivar id'>@filename</span> <span class='plus op'>+</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_SUFFIX constant id'>SUFFIX</span> <span class='plus op'>+</span> <span class='string val'>'-'</span><span class='comma token'>,</span> <span class='rubyid_@filename ivar id'>@filename</span> <span class='plus op'>+</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_SUFFIX constant id'>SUFFIX</span><span class='comma token'>,</span> <span class='symbol val'>:force=</span><span class='gt op'>&gt;</span><span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span>
      <span class='rubyid_callout identifier id'>callout</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reload-instance_method">
  
    - (<tt>Object</tt>) <strong>reload</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


932
933
934
935
936
937
938
939
940
941
942</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/frontend_httpd.rb', line 932</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_reload identifier id'>reload</span>
  <span class='rubyid_begin begin kw'>begin</span>
    <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_open identifier id'>open</span><span class='lparen token'>(</span><span class='rubyid_@filename ivar id'>@filename</span> <span class='plus op'>+</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_SUFFIX constant id'>SUFFIX</span><span class='comma token'>,</span> <span class='rubyid_Fcntl constant id'>Fcntl</span><span class='colon2 op'>::</span><span class='rubyid_O_RDONLY constant id'>O_RDONLY</span><span class='rparen token'>)</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_f identifier id'>f</span><span class='bitor op'>|</span>
      <span class='rubyid_decode_contents identifier id'>decode_contents</span><span class='lparen token'>(</span><span class='rubyid_f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Errno constant id'>Errno</span><span class='colon2 op'>::</span><span class='rubyid_ENOENT constant id'>ENOENT</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='lbrack token'>[</span><span class='rubyid_WRCREAT constant id'>WRCREAT</span><span class='comma token'>,</span> <span class='rubyid_NEWDB constant id'>NEWDB</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_@flags ivar id'>@flags</span><span class='rparen token'>)</span>
      <span class='rubyid_raise identifier id'>raise</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_block-instance_method">
  
    - (<tt>Object</tt>) <strong>update_block</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
Public, update using a block The block is called for each key, value pair
of the hash and uses the following parameters:
</p>
<pre class="code ruby18"><code class="ruby18">
   deletions   Array of keys to delete
   updates     Hash of key-&gt;value pairs to add/update
   k, v        Key and value of this iteration
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1043
1044
1045
1046
1047
1048
1049
1050
1051</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/frontend_httpd.rb', line 1043</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_update_block identifier id'>update_block</span>
  <span class='rubyid_deletions identifier id'>deletions</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='rubyid_updates identifier id'>updates</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_k identifier id'>k</span><span class='comma token'>,</span> <span class='rubyid_v identifier id'>v</span><span class='bitor op'>|</span>
    <span class='rubyid_yield yield kw'>yield</span><span class='lparen token'>(</span><span class='rubyid_deletions identifier id'>deletions</span><span class='comma token'>,</span> <span class='rubyid_updates identifier id'>updates</span><span class='comma token'>,</span> <span class='rubyid_k identifier id'>k</span><span class='comma token'>,</span> <span class='rubyid_v identifier id'>v</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_delete_if identifier id'>delete_if</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_k identifier id'>k</span><span class='comma token'>,</span> <span class='rubyid_v identifier id'>v</span><span class='bitor op'>|</span> <span class='rubyid_deletions identifier id'>deletions</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_k identifier id'>k</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_update identifier id'>update</span><span class='lparen token'>(</span><span class='rubyid_updates identifier id'>updates</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="writable?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>writable?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


944
945
946</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/node/lib/openshift-origin-node/model/frontend_httpd.rb', line 944</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_writable? fid id'>writable?</span>
  <span class='lbrack token'>[</span><span class='rubyid_WRITER constant id'>WRITER</span><span class='comma token'>,</span> <span class='rubyid_WRCREAT constant id'>WRCREAT</span><span class='comma token'>,</span> <span class='rubyid_NEWDB constant id'>NEWDB</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_@flags ivar id'>@flags</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Thu Mar 21 18:32:09 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-1.8.7).
</div>

  </body>
</html>