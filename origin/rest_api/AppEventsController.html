<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: AppEventsController
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (A)</a> &raquo;
    
    
    <span class="title">AppEventsController</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: AppEventsController
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'>BaseController</span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ActionController::Base</li>
          
            <li class="next"><span class='object_link'>BaseController</span></li>
          
            <li class="next">AppEventsController</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">origin-server/controller/app/controllers/app_events_controller.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
Application management APIs
</p>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Constant Summary</h2>
  







  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-instance_method" title="#create (instance method)">- (RestReply&lt;RestApplication&gt;) <strong>create</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
API to perform manage an application.
</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="create-instance_method">
  
    - (<tt><span class='object_link'><a href="RestReply.html" title="RestReply (class)">RestReply</a></span>&lt;<span class='object_link'><a href="RestApplication.html" title="RestApplication (class)">RestApplication</a></span>&gt;</tt>) <strong>create</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>
API to perform manage an application
</p>
<p>
URL: /domains/:domain_id/applications/:application_id/events
</p>
<p>
Action: POST
</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>event</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
Application event to create. Supported types include
</p>
<ul>
<li>start: Start all application cartridges

</li>
<li>stop: Stop all application cartridges

</li>
<li>force-stop: For all application cartridges to stop

</li>
<li>restart: Restart all application cartridges

</li>
<li>add-alias: Associate a new DNS alias with the application. Requires
<b>alias</b> parameter

</li>
<li>remove-alias: Unassociate a DNS alias from the application. Requires
<b>alias</b> parameter

</li>
<li>scale-up: Trigger a scale-up for the web framework cartridge

</li>
<li>scale-down: Trigger a scale-down for the web framework cartridge

</li>
<li>thread-dump: Retrieve a list of all threads running on all gears of the
application

</li>
<li>tidy: Trigger garbage collection and cleanup of logs, git revisions

</li>
<li>reload: Restart all application cartridges

</li>
</ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>alias</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
DNS alias for the application. Only applicable to add-alias and
remove-alias events
</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="RestReply.html" title="RestReply (class)">RestReply</a></span>&lt;<span class='object_link'><a href="RestApplication.html" title="RestApplication (class)">RestApplication</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
Application object on which the event operates and messages returned for
the event.
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'origin-server/controller/app/controllers/app_events_controller.rb', line 26</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_create identifier id'>create</span>
  <span class='rubyid_domain_id identifier id'>domain_id</span> <span class='assign token'>=</span> <span class='rubyid_params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:domain_id</span><span class='rbrack token'>]</span>
  <span class='rubyid_id identifier id'>id</span> <span class='assign token'>=</span> <span class='rubyid_params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:application_id</span><span class='rbrack token'>]</span>

  <span class='rubyid_event identifier id'>event</span> <span class='assign token'>=</span> <span class='rubyid_params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:event</span><span class='rbrack token'>]</span>
  <span class='rubyid_server_alias identifier id'>server_alias</span> <span class='assign token'>=</span> <span class='rubyid_params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:alias</span><span class='rbrack token'>]</span>

  <span class='rubyid_begin begin kw'>begin</span>
    <span class='rubyid_domain identifier id'>domain</span> <span class='assign token'>=</span> <span class='rubyid_Domain constant id'>Domain</span><span class='dot token'>.</span><span class='rubyid_find_by identifier id'>find_by</span><span class='lparen token'>(</span><span class='rubyid_owner identifier id'>owner</span><span class='colon op'>:</span> <span class='rubyid_@cloud_user ivar id'>@cloud_user</span><span class='comma token'>,</span> <span class='rubyid_canonical_namespace identifier id'>canonical_namespace</span><span class='colon op'>:</span> <span class='rubyid_domain_id identifier id'>domain_id</span><span class='dot token'>.</span><span class='rubyid_downcase identifier id'>downcase</span><span class='rparen token'>)</span>
    <span class='rubyid_@domain_name ivar id'>@domain_name</span> <span class='assign token'>=</span> <span class='rubyid_domain identifier id'>domain</span><span class='dot token'>.</span><span class='rubyid_namespace identifier id'>namespace</span>
  <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Mongoid constant id'>Mongoid</span><span class='colon2 op'>::</span><span class='rubyid_Errors constant id'>Errors</span><span class='colon2 op'>::</span><span class='rubyid_DocumentNotFound constant id'>DocumentNotFound</span>
    <span class='rubyid_return return kw'>return</span> <span class='rubyid_render_error identifier id'>render_error</span><span class='lparen token'>(</span><span class='symbol val'>:not_found</span><span class='comma token'>,</span> <span class='dstring node'>&quot;Domain #{domain_id} not found&quot;</span><span class='comma token'>,</span> <span class='integer val'>127</span><span class='comma token'>,</span>
                        <span class='string val'>&quot;APPLICATION_EVENT&quot;</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='notop op'>!</span><span class='rubyid_domain identifier id'>domain</span> <span class='orop op'>||</span> <span class='notop op'>!</span><span class='rubyid_domain identifier id'>domain</span><span class='dot token'>.</span><span class='rubyid_hasAccess? fid id'>hasAccess?</span><span class='lparen token'>(</span><span class='rubyid_@cloud_user ivar id'>@cloud_user</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_begin begin kw'>begin</span>
    <span class='rubyid_application identifier id'>application</span> <span class='assign token'>=</span> <span class='rubyid_Application constant id'>Application</span><span class='dot token'>.</span><span class='rubyid_find_by identifier id'>find_by</span><span class='lparen token'>(</span><span class='rubyid_domain identifier id'>domain</span><span class='colon op'>:</span> <span class='rubyid_domain identifier id'>domain</span><span class='comma token'>,</span> <span class='rubyid_canonical_name identifier id'>canonical_name</span><span class='colon op'>:</span> <span class='rubyid_id identifier id'>id</span><span class='dot token'>.</span><span class='rubyid_downcase identifier id'>downcase</span><span class='rparen token'>)</span>
    <span class='rubyid_@application_name ivar id'>@application_name</span> <span class='assign token'>=</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_name identifier id'>name</span>
    <span class='rubyid_@application_uuid ivar id'>@application_uuid</span> <span class='assign token'>=</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_uuid identifier id'>uuid</span>
  <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Mongoid constant id'>Mongoid</span><span class='colon2 op'>::</span><span class='rubyid_Errors constant id'>Errors</span><span class='colon2 op'>::</span><span class='rubyid_DocumentNotFound constant id'>DocumentNotFound</span>
    <span class='rubyid_return return kw'>return</span> <span class='rubyid_render_error identifier id'>render_error</span><span class='lparen token'>(</span><span class='symbol val'>:not_found</span><span class='comma token'>,</span> <span class='dstring node'>&quot;Application '#{id}' not found&quot;</span><span class='comma token'>,</span> <span class='integer val'>101</span><span class='comma token'>,</span> <span class='string val'>&quot;APPLICATION_EVENT&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_return return kw'>return</span> <span class='rubyid_render_error identifier id'>render_error</span><span class='lparen token'>(</span><span class='symbol val'>:unprocessable_entity</span><span class='comma token'>,</span> <span class='string val'>&quot;Alias must be specified for adding or removing application alias.&quot;</span><span class='comma token'>,</span> <span class='integer val'>126</span><span class='comma token'>,</span>
                      <span class='string val'>&quot;APPLICATION_EVENT&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;event&quot;</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='lbrack token'>[</span><span class='string val'>'add-alias'</span><span class='comma token'>,</span> <span class='string val'>'remove-alias'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_event identifier id'>event</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='lparen token'>(</span><span class='rubyid_server_alias identifier id'>server_alias</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span> <span class='rubyid_or or kw'>or</span> <span class='rubyid_server_alias identifier id'>server_alias</span><span class='dot token'>.</span><span class='rubyid_to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='rubyid_empty? fid id'>empty?</span><span class='rparen token'>)</span>
  <span class='rubyid_return return kw'>return</span> <span class='rubyid_render_error identifier id'>render_error</span><span class='lparen token'>(</span><span class='symbol val'>:unprocessable_entity</span><span class='comma token'>,</span> <span class='dstring node'>&quot;Reached gear limit of #{@cloud_user.max_gears}&quot;</span><span class='comma token'>,</span> <span class='integer val'>104</span><span class='comma token'>,</span>
                      <span class='string val'>&quot;APPLICATION_EVENT&quot;</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='lparen token'>(</span><span class='rubyid_event identifier id'>event</span> <span class='eq op'>==</span> <span class='string val'>'scale-up'</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='lparen token'>(</span><span class='rubyid_@cloud_user ivar id'>@cloud_user</span><span class='dot token'>.</span><span class='rubyid_consumed_gears identifier id'>consumed_gears</span> <span class='geq op'>&gt;=</span> <span class='rubyid_@cloud_user ivar id'>@cloud_user</span><span class='dot token'>.</span><span class='rubyid_max_gears identifier id'>max_gears</span><span class='rparen token'>)</span>

  <span class='rubyid_msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;Added #{event} to application #{id}&quot;</span>
  <span class='rubyid_begin begin kw'>begin</span>
    <span class='rubyid_case case kw'>case</span> <span class='rubyid_event identifier id'>event</span>
      <span class='rubyid_when when kw'>when</span> <span class='string val'>&quot;start&quot;</span>
        <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_start identifier id'>start</span>
        <span class='rubyid_msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;Application #{id} has started&quot;</span>
      <span class='rubyid_when when kw'>when</span> <span class='string val'>&quot;stop&quot;</span>
        <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_stop identifier id'>stop</span>
        <span class='rubyid_msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;Application #{id} has stopped&quot;</span>
      <span class='rubyid_when when kw'>when</span> <span class='string val'>&quot;force-stop&quot;</span>
        <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_stop identifier id'>stop</span><span class='lparen token'>(</span><span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span>
        <span class='rubyid_msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;Application #{id} has forcefully stopped&quot;</span>
      <span class='rubyid_when when kw'>when</span> <span class='string val'>&quot;restart&quot;</span>
        <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_restart identifier id'>restart</span>
        <span class='rubyid_msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;Application #{id} has restarted&quot;</span>
      <span class='rubyid_when when kw'>when</span> <span class='string val'>&quot;show-port&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;expose-port&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;conceal-port&quot;</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_render_error identifier id'>render_error</span><span class='lparen token'>(</span><span class='symbol val'>:gone</span><span class='comma token'>,</span> <span class='dstring node'>&quot;This event (#{event}) is no longer supported.&quot;</span><span class='comma token'>,</span> <span class='integer val'>112</span><span class='comma token'>,</span> <span class='string val'>&quot;APPLICATION_EVENT&quot;</span><span class='rparen token'>)</span>
      <span class='rubyid_when when kw'>when</span> <span class='string val'>&quot;add-alias&quot;</span>
        <span class='rubyid_r identifier id'>r</span> <span class='assign token'>=</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_add_alias identifier id'>add_alias</span><span class='lparen token'>(</span><span class='rubyid_server_alias identifier id'>server_alias</span><span class='rparen token'>)</span>
        <span class='rubyid_msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;Application #{id} has added alias&quot;</span>
        <span class='comment val'># msg += &quot;: #{r.resultIO.string.chomp}&quot; if !r.resultIO.string.empty?</span>
      <span class='rubyid_when when kw'>when</span> <span class='string val'>&quot;remove-alias&quot;</span>
        <span class='rubyid_begin begin kw'>begin</span>
          <span class='rubyid_a identifier id'>a</span> <span class='assign token'>=</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_aliases identifier id'>aliases</span><span class='dot token'>.</span><span class='rubyid_find_by identifier id'>find_by</span><span class='lparen token'>(</span><span class='rubyid_fqdn identifier id'>fqdn</span><span class='colon op'>:</span> <span class='rubyid_server_alias identifier id'>server_alias</span><span class='rparen token'>)</span>
          <span class='rubyid_r identifier id'>r</span> <span class='assign token'>=</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_remove_alias identifier id'>remove_alias</span><span class='lparen token'>(</span><span class='rubyid_server_alias identifier id'>server_alias</span><span class='rparen token'>)</span>
        <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Mongoid constant id'>Mongoid</span><span class='colon2 op'>::</span><span class='rubyid_Errors constant id'>Errors</span><span class='colon2 op'>::</span><span class='rubyid_DocumentNotFound constant id'>DocumentNotFound</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_ex identifier id'>ex</span>
           <span class='comment val'>#do noting as was the convention in API version &lt;= 1.3</span>
        <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;Application #{id} has removed alias&quot;</span>
        <span class='comment val'># msg += &quot;: #{r.resultIO.string.chomp}&quot; if !r.resultIO.string.empty?</span>
      <span class='rubyid_when when kw'>when</span> <span class='string val'>&quot;scale-up&quot;</span>
        <span class='rubyid_web_framework_component_instance identifier id'>web_framework_component_instance</span> <span class='assign token'>=</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_CartridgeCache constant id'>CartridgeCache</span><span class='dot token'>.</span><span class='rubyid_find_cartridge identifier id'>find_cartridge</span><span class='lparen token'>(</span><span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_categories identifier id'>categories</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='string val'>&quot;web_framework&quot;</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span>
        <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_scale_by identifier id'>scale_by</span><span class='lparen token'>(</span><span class='rubyid_web_framework_component_instance identifier id'>web_framework_component_instance</span><span class='dot token'>.</span><span class='rubyid_group_instance_id identifier id'>group_instance_id</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
        <span class='rubyid_msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;Application #{id} has scaled up&quot;</span>
      <span class='rubyid_when when kw'>when</span> <span class='string val'>&quot;scale-down&quot;</span>
        <span class='rubyid_web_framework_component_instance identifier id'>web_framework_component_instance</span> <span class='assign token'>=</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_component_instances identifier id'>component_instances</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_CartridgeCache constant id'>CartridgeCache</span><span class='dot token'>.</span><span class='rubyid_find_cartridge identifier id'>find_cartridge</span><span class='lparen token'>(</span><span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_cartridge_name identifier id'>cartridge_name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_categories identifier id'>categories</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='string val'>&quot;web_framework&quot;</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span>
        <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_scale_by identifier id'>scale_by</span><span class='lparen token'>(</span><span class='rubyid_web_framework_component_instance identifier id'>web_framework_component_instance</span><span class='dot token'>.</span><span class='rubyid_group_instance_id identifier id'>group_instance_id</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='rparen token'>)</span>
        <span class='rubyid_msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;Application #{id} has scaled down&quot;</span>
      <span class='rubyid_when when kw'>when</span> <span class='string val'>&quot;thread-dump&quot;</span>
        <span class='rubyid_r identifier id'>r</span> <span class='assign token'>=</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_threaddump identifier id'>threaddump</span>
        <span class='rubyid_if if kw'>if</span> <span class='rubyid_r identifier id'>r</span><span class='dot token'>.</span><span class='rubyid_nil? fid id'>nil?</span>
          <span class='rubyid_msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
        <span class='rubyid_else else kw'>else</span>
          <span class='rubyid_msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='notop op'>!</span><span class='rubyid_r identifier id'>r</span><span class='dot token'>.</span><span class='rubyid_errorIO identifier id'>errorIO</span><span class='dot token'>.</span><span class='rubyid_string identifier id'>string</span><span class='dot token'>.</span><span class='rubyid_empty? fid id'>empty?</span> <span class='integer val'>? </span><span class='rubyid_r identifier id'>r</span><span class='dot token'>.</span><span class='rubyid_errorIO identifier id'>errorIO</span><span class='dot token'>.</span><span class='rubyid_string identifier id'>string</span><span class='dot token'>.</span><span class='rubyid_chomp identifier id'>chomp</span> <span class='colon op'>:</span> <span class='rubyid_r identifier id'>r</span><span class='dot token'>.</span><span class='rubyid_resultIO identifier id'>resultIO</span><span class='dot token'>.</span><span class='rubyid_string identifier id'>string</span><span class='dot token'>.</span><span class='rubyid_chomp identifier id'>chomp</span>
        <span class='rubyid_end end kw'>end</span>
        <span class='comment val'>#TODO: We need to reconsider how we are reporting messages to the client</span>
        <span class='rubyid_message identifier id'>message</span> <span class='assign token'>=</span> <span class='rubyid_Message constant id'>Message</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:result</span><span class='comma token'>,</span> <span class='rubyid_msg identifier id'>msg</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
        <span class='rubyid_app identifier id'>app</span> <span class='assign token'>=</span> <span class='rubyid_if if kw'>if</span> <span class='rubyid_requested_api_version identifier id'>requested_api_version</span> <span class='eq op'>==</span> <span class='float val'>1.0</span>
            <span class='rubyid_RestApplication10 constant id'>RestApplication10</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_application identifier id'>application</span><span class='comma token'>,</span> <span class='rubyid_domain identifier id'>domain</span><span class='comma token'>,</span> <span class='rubyid_get_url identifier id'>get_url</span><span class='comma token'>,</span> <span class='rubyid_nolinks identifier id'>nolinks</span><span class='rparen token'>)</span>
          <span class='rubyid_else else kw'>else</span>
            <span class='rubyid_RestApplication constant id'>RestApplication</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_application identifier id'>application</span><span class='comma token'>,</span> <span class='rubyid_domain identifier id'>domain</span><span class='comma token'>,</span> <span class='rubyid_get_url identifier id'>get_url</span><span class='comma token'>,</span> <span class='rubyid_nolinks identifier id'>nolinks</span><span class='rparen token'>)</span>
          <span class='rubyid_end end kw'>end</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_render_success identifier id'>render_success</span><span class='lparen token'>(</span><span class='symbol val'>:ok</span><span class='comma token'>,</span> <span class='string val'>&quot;application&quot;</span><span class='comma token'>,</span> <span class='rubyid_app identifier id'>app</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{event.sub('-', '_').upcase}_APPLICATION&quot;</span><span class='comma token'>,</span> <span class='dstring node'>&quot;Application event '#{event}' successful&quot;</span><span class='comma token'>,</span> <span class='rubyid_true true kw'>true</span><span class='comma token'>,</span> <span class='rubyid_nil nil kw'>nil</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='rubyid_message identifier id'>message</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='rubyid_when when kw'>when</span> <span class='string val'>'tidy'</span>
        <span class='rubyid_r identifier id'>r</span> <span class='assign token'>=</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_tidy identifier id'>tidy</span>
        <span class='rubyid_msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;Application #{id} called tidy&quot;</span>
        <span class='comment val'># msg += &quot;: #{r.resultIO.string.chomp}&quot; if !r.resultIO.string.empty?</span>
      <span class='rubyid_when when kw'>when</span> <span class='string val'>'reload'</span>
        <span class='rubyid_r identifier id'>r</span> <span class='assign token'>=</span> <span class='rubyid_application identifier id'>application</span><span class='dot token'>.</span><span class='rubyid_reload_config identifier id'>reload_config</span>
        <span class='rubyid_msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;Application #{id} called reload&quot;</span>
        <span class='comment val'># msg += &quot;: #{r.resultIO.string.chomp}&quot; if !r.resultIO.string.empty?</span>
      <span class='rubyid_else else kw'>else</span>
        <span class='rubyid_return return kw'>return</span> <span class='rubyid_render_error identifier id'>render_error</span><span class='lparen token'>(</span><span class='symbol val'>:unprocessable_entity</span><span class='comma token'>,</span> <span class='dstring node'>&quot;Invalid application event '#{event}' specified&quot;</span><span class='comma token'>,</span>
                            <span class='integer val'>126</span><span class='comma token'>,</span> <span class='string val'>&quot;APPLICATION_EVENT&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;event&quot;</span><span class='rparen token'>)</span>
      <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_LockUnavailableException constant id'>LockUnavailableException</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
    <span class='rubyid_return return kw'>return</span> <span class='rubyid_render_error identifier id'>render_error</span><span class='lparen token'>(</span><span class='symbol val'>:service_unavailable</span><span class='comma token'>,</span> <span class='string val'>&quot;Application is currently busy performing another operation. Please try again in a minute.&quot;</span><span class='comma token'>,</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_code identifier id'>code</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{event.sub('-', '_').upcase}_APPLICATION&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_OpenShift constant id'>OpenShift</span><span class='colon2 op'>::</span><span class='rubyid_UserException constant id'>UserException</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_uex identifier id'>uex</span>
    <span class='rubyid_return return kw'>return</span> <span class='rubyid_render_error identifier id'>render_error</span><span class='lparen token'>(</span><span class='symbol val'>:unprocessable_entity</span><span class='comma token'>,</span> <span class='rubyid_uex identifier id'>uex</span><span class='dot token'>.</span><span class='rubyid_message identifier id'>message</span><span class='comma token'>,</span> <span class='rubyid_uex identifier id'>uex</span><span class='dot token'>.</span><span class='rubyid_code identifier id'>code</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{event.sub('-', '_').upcase}_APPLICATION&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_rescue rescue kw'>rescue</span> <span class='rubyid_Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
    <span class='rubyid_return return kw'>return</span> <span class='rubyid_render_exception identifier id'>render_exception</span><span class='lparen token'>(</span><span class='rubyid_e identifier id'>e</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{event.sub('-', '_').upcase}_APPLICATION&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_application identifier id'>application</span> <span class='assign token'>=</span> <span class='rubyid_Application constant id'>Application</span><span class='dot token'>.</span><span class='rubyid_find_by identifier id'>find_by</span><span class='lparen token'>(</span><span class='rubyid_domain identifier id'>domain</span><span class='colon op'>:</span> <span class='rubyid_domain identifier id'>domain</span><span class='comma token'>,</span> <span class='rubyid_canonical_name identifier id'>canonical_name</span><span class='colon op'>:</span> <span class='rubyid_id identifier id'>id</span><span class='dot token'>.</span><span class='rubyid_downcase identifier id'>downcase</span><span class='rparen token'>)</span>
  <span class='rubyid_app identifier id'>app</span> <span class='assign token'>=</span> <span class='rubyid_if if kw'>if</span> <span class='rubyid_requested_api_version identifier id'>requested_api_version</span> <span class='eq op'>==</span> <span class='float val'>1.0</span>
      <span class='rubyid_RestApplication10 constant id'>RestApplication10</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_application identifier id'>application</span><span class='comma token'>,</span> <span class='rubyid_domain identifier id'>domain</span><span class='comma token'>,</span> <span class='rubyid_get_url identifier id'>get_url</span><span class='comma token'>,</span> <span class='rubyid_nolinks identifier id'>nolinks</span><span class='rparen token'>)</span>
    <span class='rubyid_else else kw'>else</span>
      <span class='rubyid_RestApplication constant id'>RestApplication</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_application identifier id'>application</span><span class='comma token'>,</span> <span class='rubyid_domain identifier id'>domain</span><span class='comma token'>,</span> <span class='rubyid_get_url identifier id'>get_url</span><span class='comma token'>,</span> <span class='rubyid_nolinks identifier id'>nolinks</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_@reply ivar id'>@reply</span> <span class='assign token'>=</span> <span class='rubyid_new_rest_reply identifier id'>new_rest_reply</span><span class='lparen token'>(</span><span class='symbol val'>:ok</span><span class='comma token'>,</span> <span class='string val'>&quot;application&quot;</span><span class='comma token'>,</span> <span class='rubyid_app identifier id'>app</span><span class='rparen token'>)</span>
  <span class='rubyid_message identifier id'>message</span> <span class='assign token'>=</span> <span class='rubyid_Message constant id'>Message</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;INFO&quot;</span><span class='comma token'>,</span> <span class='rubyid_msg identifier id'>msg</span><span class='rparen token'>)</span>
  <span class='rubyid_@reply ivar id'>@reply</span><span class='dot token'>.</span><span class='rubyid_messages identifier id'>messages</span><span class='dot token'>.</span><span class='rubyid_push identifier id'>push</span><span class='lparen token'>(</span><span class='rubyid_message identifier id'>message</span><span class='rparen token'>)</span>
  <span class='rubyid_respond_with identifier id'>respond_with</span> <span class='rubyid_@reply ivar id'>@reply</span><span class='comma token'>,</span> <span class='symbol val'>:status</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_@reply ivar id'>@reply</span><span class='dot token'>.</span><span class='rubyid_status identifier id'>status</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Mar 22 18:24:42 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-1.8.7).
</div>

  </body>
</html>